<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="Learn and live."><title>pyautogui使用 | Simple &amp; Freedom</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/7.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">pyautogui使用</h1><a id="logo" href="/.">Simple &amp; Freedom</a><p class="description">Learn and live.</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/404.html"><i class="fa fa-heartbeat"> 公益404</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">pyautogui使用</h1><div class="post-meta">Jul 27, 2017<span> | </span><span class="category"><a href="/categories/编程/">编程</a></span></div><div class="post-content"><h3 id="PyAutoGUI——让所有GUI都自动化"><a href="#PyAutoGUI——让所有GUI都自动化" class="headerlink" title="PyAutoGUI——让所有GUI都自动化"></a>PyAutoGUI——让所有GUI都自动化</h3><p>本教程译自大神Al Sweigart的PyAutoGUI项目，Python自动化工具，更适合处理GUI任务，网页任务推荐：</p>
<ul>
<li>Selenium+Firefox记录（Chromedriver和Phantomjs也很给力，Phantomjs虽然是无头浏览器，但有时定位不准），然后用Python写单元测试</li>
<li>request处理get/post请求写一堆代码自动化处理，都在后台运行，不用运行浏览器，非常适合处理表单</li>
</ul>
<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>PyAutoGUI是一个纯Python的GUI自动化工具，其目的是可以用程序自动控制鼠标和键盘操作，多平台支持（Windows，OS X，Linux）。可以用pip安装，Github上有<a href="https://github.com/asweigart/pyautogui" target="_blank" rel="external">源代码</a>。</p>
<p>PyAutoGUI可以模拟鼠标的移动、点击、拖拽，键盘按键输入、按住操作，以及鼠标+键盘的热键同时按住等操作，可以说手能动的都可以。</p>
<p>让鼠标移到屏幕中央<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> pyautogui</div><div class="line">screenWidth, screenHeight = pyautogui.size()</div><div class="line">pyautogui.moveTo(screenWidth / <span class="number">2</span>, screenHeight / <span class="number">2</span>)</div></pre></td></tr></table></figure></p>
<p>一些例子:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> pyautogui</div><div class="line">screenWidth, screenHeight = pyautogui.size()</div><div class="line">currentMouseX, currentMouseY = pyautogui.position()</div><div class="line">pyautogui.moveTo(<span class="number">100</span>, <span class="number">150</span>)</div><div class="line">pyautogui.click()</div><div class="line"><span class="comment">#  鼠标向下移动10像素</span></div><div class="line">pyautogui.moveRel(<span class="keyword">None</span>, <span class="number">10</span>)</div><div class="line">pyautogui.doubleClick()</div><div class="line"><span class="comment">#  用缓动/渐变函数让鼠标2秒后移动到(500,500)位置</span></div><div class="line"><span class="comment">#  use tweening/easing function to move mouse over 2 seconds.</span></div><div class="line">pyautogui.moveTo(<span class="number">1800</span>, <span class="number">500</span>, duration=<span class="number">2</span>, tween=pyautogui.easeInOutQuad)</div><div class="line"><span class="comment">#  在每次输入之间暂停0.25秒</span></div><div class="line">pyautogui.typewrite(<span class="string">'Hello world!'</span>, interval=<span class="number">0.25</span>)</div><div class="line">pyautogui.press(<span class="string">'esc'</span>)</div><div class="line">pyautogui.keyDown(<span class="string">'shift'</span>)</div><div class="line">pyautogui.press([<span class="string">'left'</span>, <span class="string">'left'</span>, <span class="string">'left'</span>, <span class="string">'left'</span>, <span class="string">'left'</span>, <span class="string">'left'</span>])</div><div class="line">pyautogui.keyUp(<span class="string">'shift'</span>)</div><div class="line">pyautogui.hotkey(<span class="string">'ctrl'</span>, <span class="string">'c'</span>)</div></pre></td></tr></table></figure></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">distance = <span class="number">200</span></div><div class="line"><span class="keyword">while</span> distance &gt; <span class="number">0</span>:</div><div class="line">    pyautogui.dragRel(distance, <span class="number">0</span>, duration=<span class="number">0.5</span>) <span class="comment"># 向右</span></div><div class="line">    distance -= <span class="number">5</span></div><div class="line">    pyautogui.dragRel(<span class="number">0</span>, distance, duration=<span class="number">0.5</span>) <span class="comment"># 向下</span></div><div class="line">    pyautogui.draIn gRel(-distance, <span class="number">0</span>, duration=<span class="number">0.5</span>) <span class="comment"># 向左</span></div><div class="line">    distance -= <span class="number">5</span></div><div class="line">    pyautogui.dragRel(<span class="number">0</span>, -distance, duration=<span class="number">0.5</span>) <span class="comment"># 向上</span></div></pre></td></tr></table></figure>
<h3 id="保护措施"><a href="#保护措施" class="headerlink" title="保护措施"></a>保护措施</h3><p>为了能够及时中断，PyAutoGUI提供了一个保护措施。当pyautogui.FAILSAFE = True时，如果把鼠标光标在屏幕左上角，PyAutoGUI函数就会产生pyautogui.FailSafeException异常。如果失控了，需要中断PyAutoGUI函数，就把鼠标光标在屏幕左上角。要禁用这个特性，就把FAILSAFE设置成False：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> pyautogui</div><div class="line">pyautogui.FAILSAFE = <span class="keyword">False</span></div></pre></td></tr></table></figure></p>
<p>通过把pyautogui.PAUSE设置成float或int时间（秒），可以为所有的PyAutoGUI函数增加延迟。默认延迟时间是0.1秒。在函数循环执行的时候，这样做可以让PyAutoGUI运行的慢一点，非常有用。例如：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> pyautogui</div><div class="line">pyautogui.PAUSE = <span class="number">2.5</span></div><div class="line">pyautogui.moveTo(<span class="number">100</span>,<span class="number">100</span>); pyautogui.click()</div></pre></td></tr></table></figure></p>
<p>所有的PyAutoGUI函数在延迟完成前都处于阻塞状态（block）。（未来计划增加一个可选的非阻塞模式来调用函数。）建议PAUSE和FAILSAFE一起使用。</p>
<h3 id="Cheat-Sheet"><a href="#Cheat-Sheet" class="headerlink" title="Cheat Sheet"></a>Cheat Sheet</h3><h4 id="常用函数"><a href="#常用函数" class="headerlink" title="常用函数"></a>常用函数</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> pyautogui</div><div class="line"><span class="comment">#  当前鼠标的坐标</span></div><div class="line">pyautogui.position() <span class="comment"># (123, 372)</span></div><div class="line"><span class="comment">#  当前屏幕的分辨率（宽度和高度）</span></div><div class="line">pyautogui.size()  <span class="comment"># (1920, 1080)</span></div><div class="line"><span class="comment">#  (x,y)是否在屏幕上</span></div><div class="line">x, y = <span class="number">122</span>, <span class="number">244</span></div><div class="line">pyautogui.onScreen(x, y)  <span class="comment"># True</span></div></pre></td></tr></table></figure>
<h4 id="保护措施-1"><a href="#保护措施-1" class="headerlink" title="保护措施"></a>保护措施</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># PyAutoGUI函数增加延迟为2.5秒：</span></div><div class="line">pyautogui.PAUSE = <span class="number">2.5</span></div><div class="line"><span class="comment"># 当pyautogui.FAILSAFE = True时，如果把鼠标光标在屏幕左上角，PyAutoGUI函数就会产生pyautogui.FailSafeException异常。</span></div><div class="line">pyautogui.FAILSAFE = <span class="keyword">True</span></div></pre></td></tr></table></figure>
<h4 id="鼠标函数"><a href="#鼠标函数" class="headerlink" title="鼠标函数"></a>鼠标函数</h4><p>坐标系的原点是左上角。X轴（水平）坐标向右增大，Y轴（竖直）坐标向下增大。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">num_seconds = <span class="number">1.2</span></div><div class="line"><span class="comment">#  用num_seconds秒的时间把光标移动到(x, y)位置</span></div><div class="line">pyautogui.moveTo(x, y, duration=num_seconds)</div><div class="line"><span class="comment">#  用num_seconds秒的时间把光标的X轴（水平）坐标移动xOffset，</span></div><div class="line"><span class="comment">#  Y轴（竖直）坐标向下移动yOffset。</span></div><div class="line">xOffset, yOffset = <span class="number">50</span>, <span class="number">100</span></div><div class="line">pyautogui.moveRel(xOffset, yOffset, duration=num_seconds)</div></pre></td></tr></table></figure></p>
<p>click()函数就是让鼠标点击，默认是单击左键，参数可以设置,其中，button属性可以设置成left，middle和right。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pyautogui.click(x=moveToX, y=moveToY, clicks=num_of_clicks, interval=secs_between_clicks, button=<span class="string">'left'</span>)</div></pre></td></tr></table></figure></p>
<p>所有的点击都可以用这个函数，不过下面的函数可读性更好：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">pyautogui.rightClick(x=moveToX, y=moveToY)</div><div class="line">pyautogui.middleClick(x=moveToX, y=moveToY)</div><div class="line">pyautogui.doubleClick(x=moveToX, y=moveToY)</div><div class="line">pyautogui.tripleClick(x=moveToX, y=moveToY)</div></pre></td></tr></table></figure></p>
<p>scroll函数控制鼠标滚轮的滚动，<code>amount_to_scroll</code>参数表示滚动的格数。正数则页面向上滚动，负数则向下滚动：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pyautogui.scroll(clicks=amount_to_scroll, x=moveToX, y=moveToY)</div></pre></td></tr></table></figure></p>
<p>每个按键按下和松开两个事件可以分开处理：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">pyautogui.mouseDown(x=moveToX, y=moveToY, button=<span class="string">'left'</span>)</div><div class="line">pyautogui.mouseUp(x=moveToX, y=moveToY, button=<span class="string">'left'</span>)</div></pre></td></tr></table></figure></p>
<h3 id="键盘函数"><a href="#键盘函数" class="headerlink" title="键盘函数"></a>键盘函数</h3><p>键盘上可以按的键都可以调用：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#  每次键入的时间间隔</span></div><div class="line">secs_between_keys = <span class="number">0.1</span></div><div class="line">pyautogui.typewrite(<span class="string">'Hello world!\n'</span>, interval=secs_between_keys)</div></pre></td></tr></table></figure></p>
<p>多个键也可以：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pyautogui.typewrite([<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'left'</span>, <span class="string">'backspace'</span>, <span class="string">'enter'</span>, <span class="string">'f1'</span>], interval=secs_between_keys)</div></pre></td></tr></table></figure></p>
<p>按键名称列表：<code>pyautogui.KEYBOARD_KEYS[:10]</code><br>[‘\t’, ‘\n’, ‘\r’, ‘ ‘, ‘!’, ‘“‘, ‘#’, ‘$’, ‘%’, ‘&amp;’]</p>
<p>键盘的一些热键像Ctrl-S或Ctrl-Shift-1都可以用hotkey()函数来实现：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">pyautogui.hotkey(<span class="string">'ctrl'</span>, <span class="string">'a'</span>) <span class="comment"># 全选</span></div><div class="line">pyautogui.hotkey(<span class="string">'ctrl'</span>, <span class="string">'c'</span>) <span class="comment"># 复制</span></div><div class="line">pyautogui.hotkey(<span class="string">'ctrl'</span>, <span class="string">'v'</span>) <span class="comment"># 粘贴</span></div></pre></td></tr></table></figure></p>
<p>每个按键的按下和松开也可以单独调用：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">pyautogui.keyDown(key_name)</div><div class="line">pyautogui.keyUp(key_name)</div></pre></td></tr></table></figure></p>
<h3 id="消息弹窗函数"><a href="#消息弹窗函数" class="headerlink" title="消息弹窗函数"></a>消息弹窗函数</h3><p>如果你需要消息弹窗，通过单击OK暂停程序，或者向用户显示一些信息，消息弹窗函数就会有类似JavaScript的功能：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">pyautogui.alert(<span class="string">'这个消息弹窗是文字+OK按钮'</span>)</div><div class="line">pyautogui.confirm(<span class="string">'这个消息弹窗是文字+OK+Cancel按钮'</span>)</div><div class="line">pyautogui.prompt(<span class="string">'这个消息弹窗是让用户输入字符串，单击OK'</span>)</div><div class="line"><span class="comment"># 在prompt()函数中，如果用户什么都不输入，就会返回None。</span></div></pre></td></tr></table></figure></p>
<h3 id="截屏函数"><a href="#截屏函数" class="headerlink" title="截屏函数"></a>截屏函数</h3><p>PyAutoGUI用Pillow/PIL库实现图片相关的识别和操作。<br>在Linux里面，你必须执行<code>sudo apt-get install scrot</code>来使用截屏特性。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#  返回一个Pillow/PIL的Image对象</span></div><div class="line">pyautogui.screenshot()</div><div class="line">pyautogui.screenshot(<span class="string">'foo.png'</span>)</div></pre></td></tr></table></figure></p>
<p>如果你有一个图片文件想在上面做点击操作，你可以用locateOnScreen()函数来定位。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#  返回(最左x坐标，最顶y坐标，宽度，高度)</span></div><div class="line">pyautogui.locateOnScreen(<span class="string">'pyautogui/looks.png'</span>)</div><div class="line"><span class="comment"># (0, 1040, 48, 40)</span></div></pre></td></tr></table></figure></p>
<p>locateAllOnScreen()函数会寻找所有相似图片，返回一个生成器：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> pyautogui.locateAllOnScreen(<span class="string">'pyautogui/looks.png'</span>):</div><div class="line">    print(i)</div><div class="line"><span class="comment"># (0, 1040, 48, 40)</span></div><div class="line">list(pyautogui.locateAllOnScreen(<span class="string">'pyautogui/looks.png'</span>))</div><div class="line"><span class="comment"># (0, 1040, 48, 40)</span></div></pre></td></tr></table></figure></p>
<p>locateCenterOnScreen()函数会返回图片在屏幕上的中心XY轴坐标值：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">pyautogui.locateCenterOnScreen(<span class="string">'pyautogui/looks.png'</span>)</div><div class="line"><span class="comment"># (24, 1060)</span></div></pre></td></tr></table></figure></p>
<p>如果没找到图片会返回None。定位比较慢，一般得用1~2秒.</p>
<h3 id="常用函数-1"><a href="#常用函数-1" class="headerlink" title="常用函数"></a>常用函数</h3><p>position()：返回整数元组(x, y)，分别表示鼠标光标所在位置的XY轴坐标<br>size()：返回显示器的尺寸整数元组(x, y)。未来将加入多屏支持</p>
<h3 id="鼠标控制函数"><a href="#鼠标控制函数" class="headerlink" title="鼠标控制函数"></a>鼠标控制函数</h3><h4 id="屏幕与鼠标位置"><a href="#屏幕与鼠标位置" class="headerlink" title="屏幕与鼠标位置"></a>屏幕与鼠标位置</h4><p>屏幕位置使用X和Y轴的笛卡尔坐标系。原点(0,0)在左上角，分别向右、向下增大。<br>如果屏幕像素是 1920×1080，那么右下角的坐标是(1919, 1079), 左上角是从(0, 0)开始的。<br>分辨率大小可以通过size()函数返回整数元组。光标的位置用position()返回。例如：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">pyautogui.size()</div><div class="line"><span class="comment"># (1920, 1080)</span></div><div class="line">pyautogui.position()</div><div class="line"><span class="comment"># (272, 688)</span></div></pre></td></tr></table></figure></p>
<p>下面是Python 3版本的光标位置记录程序：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># ! python 3</span></div><div class="line"><span class="keyword">import</span> pyautogui</div><div class="line">print(<span class="string">'Press Ctrl-C to quit'</span>)</div><div class="line"><span class="keyword">try</span>:</div><div class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">        x, y = pyautogui.position()</div><div class="line">        positionStr = <span class="string">'X: &#123;&#125; Y: &#123;&#125;'</span>.format(*[str(x).rjust(<span class="number">4</span>) <span class="keyword">for</span> x <span class="keyword">in</span> [x, y]])</div><div class="line">        print(positionStr, end=<span class="string">''</span>)</div><div class="line">        print(<span class="string">'\b'</span> * len(positionStr), end=<span class="string">''</span>, flush=<span class="keyword">True</span>)</div><div class="line"><span class="keyword">except</span> KeyboardInterrupt:</div><div class="line">    print(<span class="string">'\n'</span>)</div></pre></td></tr></table></figure></p>
<p>要检查XY坐标是否在屏幕上，需要用onScreen()函数来检验，如果在屏幕上返回True：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> pyautogui</div><div class="line">pyautogui.onScreen(<span class="number">0</span>, <span class="number">0</span>) <span class="comment"># True</span></div><div class="line">pyautogui.onScreen(<span class="number">0</span>, <span class="number">-1</span>) <span class="comment"># False</span></div><div class="line">pyautogui.onScreen(<span class="number">0</span>, <span class="number">2080</span>) <span class="comment"># False</span></div><div class="line">pyautogui.onScreen(<span class="number">1920</span>, <span class="number">1080</span>) <span class="comment"># False</span></div><div class="line">pyautogui.onScreen(<span class="number">1919</span>, <span class="number">1079</span>) <span class="comment"># True</span></div></pre></td></tr></table></figure></p>
<h4 id="鼠标行为"><a href="#鼠标行为" class="headerlink" title="鼠标行为"></a>鼠标行为</h4><p>moveTo()函数会把鼠标光标移动到指定的XY轴坐标处。如果传入None值，则表示使用当前光标的对象轴坐标值。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">pyautogui.moveTo(<span class="number">100</span>, <span class="number">200</span>)     <span class="comment"># 光标移动到(100, 200)位置</span></div><div class="line">pyautogui.moveTo(<span class="keyword">None</span>, <span class="number">500</span>)   <span class="comment"># 光标移动到(100, 500)位置</span></div><div class="line">pyautogui.moveTo(<span class="number">600</span>, <span class="keyword">None</span>)   <span class="comment"># 光标移动到(600, 500)位置</span></div><div class="line"><span class="comment">#一般鼠标光标都是瞬间移动到指定的位置，如果你想让鼠标移动的慢点，可以设置持续时间：</span></div><div class="line">pyautogui.moveTo(<span class="number">100</span>, <span class="number">200</span>, duration=<span class="number">2</span>)     <span class="comment"># 用2秒把光标移动到(100, 200)位置</span></div></pre></td></tr></table></figure></p>
<p>默认的持续时间pyautogui.MINIMUM_DURATION是0.1秒，如果你设置的时间比默认值还短，那么就会瞬间执行。</p>
<p>如果你想让光标以当前位置为原点，进行相对移动，就用pyautogui.moveRel()函数。例如：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">pyautogui.moveTo(<span class="number">100</span>, <span class="number">200</span>) <span class="comment">#把光标移动到(100, 200)位置</span></div><div class="line">pyautogui.moveRel(<span class="number">0</span>, <span class="number">50</span>)   <span class="comment">#向下移动50</span></div><div class="line">pyautogui.moveRel(<span class="number">30</span>, <span class="number">0</span>, <span class="number">2</span>)   <span class="comment">#向右移动30</span></div><div class="line">pyautogui.moveRel(<span class="number">30</span>, <span class="keyword">None</span>)   <span class="comment">#向右移动30</span></div></pre></td></tr></table></figure></p>
<h4 id="鼠标拖拽"><a href="#鼠标拖拽" class="headerlink" title="鼠标拖拽"></a>鼠标拖拽</h4><p>PyAutoGUI的dragTo()和dragRel()函数与moveTo()和moveRel()函数类似。另外，他们有一个button参数可以设置成left，middle和right三个键。例如：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#  按住鼠标左键，把鼠标拖拽到(100, 200)位置</span></div><div class="line">pyautogui.dragTo(<span class="number">100</span>, <span class="number">200</span>, button=<span class="string">'left'</span>)</div><div class="line"><span class="comment">#  按住鼠标左键，用2秒钟把鼠标拖拽到(300, 400)位置</span></div><div class="line">pyautogui.dragTo(<span class="number">300</span>, <span class="number">400</span>, <span class="number">2</span>, button=<span class="string">'left'</span>)</div><div class="line"><span class="comment">#  按住鼠标右键，用2秒钟把鼠标拖拽到(30,0)位置</span></div><div class="line">pyautogui.dragTo(<span class="number">30</span>, <span class="number">0</span>, <span class="number">2</span>, button=<span class="string">'right'</span>)</div></pre></td></tr></table></figure></p>
<h4 id="缓动-渐变（Tween-Easing）函数"><a href="#缓动-渐变（Tween-Easing）函数" class="headerlink" title="缓动/渐变（Tween / Easing）函数"></a>缓动/渐变（Tween / Easing）函数</h4><p>缓动/渐变函数的作用是让光标的移动更炫。如果你不需要用到的话，你可以忽略这些。</p>
<p>缓动/渐变函数可以改变光标移动过程的速度和方向。通常鼠标是匀速直线运动，这就是线性缓动/渐变函数。PyAutoGUI有30种缓动/渐变函数，可以通过<code>pyautogui.ease*?</code>查看。其中，pyautogui.easeInQuad()函数可以用于moveTo()，moveRel()，dragTo()和dragRel()函数，光标移动呈现先慢后快的效果，整个过程的时间还是和原来一样。而pyautogui.easeOutQuad函数的效果相反：光标开始移动很快，然后慢慢减速。pyautogui.easeOutElastic是弹簧效果，首先越过终点，然后再反弹回来。例如：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#  开始很慢，不断加速</span></div><div class="line">pyautogui.moveTo(<span class="number">100</span>, <span class="number">100</span>, <span class="number">2</span>, pyautogui.easeInQuad)</div><div class="line"><span class="comment">#  开始很快，不断减速</span></div><div class="line">pyautogui.moveTo(<span class="number">100</span>, <span class="number">100</span>, <span class="number">2</span>, pyautogui.easeOutQuad)</div><div class="line"><span class="comment">#  开始和结束都快，中间比较慢</span></div><div class="line">pyautogui.moveTo(<span class="number">100</span>, <span class="number">100</span>, <span class="number">2</span>, pyautogui.easeInOutQuad)</div><div class="line"><span class="comment">#  一步一徘徊前进</span></div><div class="line">pyautogui.moveTo(<span class="number">100</span>, <span class="number">100</span>, <span class="number">2</span>, pyautogui.easeInBounce)</div><div class="line"><span class="comment">#  徘徊幅度更大，甚至超过起点和终点</span></div><div class="line">pyautogui.moveTo(<span class="number">100</span>, <span class="number">100</span>, <span class="number">2</span>, pyautogui.easeInElastic)</div></pre></td></tr></table></figure></p>
<p>这些效果函数是模仿Al Sweigart的PyTweening模块，可以直接使用，不需要额外安装。<br>如果你想创建自己的效果，也可以定义一个函数，其参数是(0.0,1.0)，表示起点和终点，返回值是介于[0.0,1.0]之间的数。</p>
<h4 id="鼠标单击"><a href="#鼠标单击" class="headerlink" title="鼠标单击"></a>鼠标单击</h4><p>click()函数模拟单击鼠标左键一次的行为。例如：<code>pyautogui.click()</code><br>如果单击之前要先移动，可以把目标的XY坐标值传入函数：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#  先移动到(100, 200)再单击</span></div><div class="line">pyautogui.click(x=<span class="number">100</span>, y=<span class="number">200</span>, duration=<span class="number">2</span>)</div><div class="line"><span class="comment"># 可以通过button参数设置left，middle和right三个键。例如：</span></div><div class="line">pyautogui.click(button=<span class="string">'right'</span>)</div></pre></td></tr></table></figure></p>
<p>要做多次单击可以设置clicks参数，还有interval参数可以设置每次单击之间的时间间隔。例如：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#  双击左键</span></div><div class="line">pyautogui.click(clicks=<span class="number">2</span>)</div><div class="line"><span class="comment">#  两次单击之间停留0.25秒</span></div><div class="line">pyautogui.click(clicks=<span class="number">2</span>, interval=<span class="number">0.25</span>)</div><div class="line"><span class="comment">#  三击右键</span></div><div class="line">pyautogui.click(button=<span class="string">'right'</span>, clicks=<span class="number">2</span>, interval=<span class="number">0.25</span>)</div></pre></td></tr></table></figure></p>
<p>为了操作方便，PyAutoGUI提供了doubleClick()，tripleClick()和rightClick()来实现双击、三击和右击操作。</p>
<h4 id="鼠标按下和松开函数"><a href="#鼠标按下和松开函数" class="headerlink" title="鼠标按下和松开函数"></a>鼠标按下和松开函数</h4><p>mouseDown()和mouseUp()函数可以实现鼠标按下和鼠标松开的操作。两者参数相同，有x，y和button。例如：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#  鼠标左键按下再松开</span></div><div class="line">pyautogui.mouseDown(); pyautogui.mouseUp() </div><div class="line"><span class="comment">#  按下鼠标右键</span></div><div class="line">pyautogui.mouseDown(button=<span class="string">'right'</span>) </div><div class="line"><span class="comment">#  移动到(100, 200)位置，然后松开鼠标右键</span></div><div class="line">pyautogui.mouseUp(button=<span class="string">'right'</span>, x=<span class="number">100</span>, y=<span class="number">200</span>)</div></pre></td></tr></table></figure></p>
<h4 id="滚轮滚动函数"><a href="#滚轮滚动函数" class="headerlink" title="滚轮滚动函数"></a>滚轮滚动函数</h4><p>鼠标滚轮滚动可以用scroll()函数和clicks次数参数来模拟。scroll()函数是vscroll()的一个包装（wrapper），执行竖直滚动。<br>不同平台上的clicks次数不太一样。还有x和y参数可以在滚动之前定位到(x, y)位置。例如：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#  向上滚动10格</span></div><div class="line">pyautogui.scroll(<span class="number">10</span>)</div><div class="line"><span class="comment">#  向下滚动10格</span></div><div class="line">pyautogui.scroll(<span class="number">-10</span>)</div><div class="line"><span class="comment">#  移动到(100, 100)位置再向上滚动10格</span></div><div class="line">pyautogui.scroll(<span class="number">10</span>, x=<span class="number">100</span>, y=<span class="number">100</span>)</div><div class="line"><span class="comment"># 在OS X和Linux平台上，PyAutoGUI还可以用hscroll()实现水平滚动。例如：</span></div><div class="line"><span class="comment">#  向右滚动10格</span></div><div class="line">pyautogui.hscroll(<span class="number">10</span>)</div><div class="line"><span class="comment">#  向左滚动10格</span></div><div class="line">pyautogui.hscroll(<span class="number">-10</span>)</div></pre></td></tr></table></figure></p>
<h3 id="键盘控制函数"><a href="#键盘控制函数" class="headerlink" title="键盘控制函数"></a>键盘控制函数</h3><h4 id="typewrite-输入函数"><a href="#typewrite-输入函数" class="headerlink" title="typewrite()输入函数"></a>typewrite()输入函数</h4><p>键盘控制的主要函数就是typewrite()。这个函数可以实现字符输入。typewrite()函数只能用于单个字符键，不能按SHITF和F1这些功能键。要在两次输入间增加时间间隔，可以用interval参数。例如：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#  输入Hello world!</span></div><div class="line">pyautogui.typewrite(<span class="string">'Hello world!'</span>)</div><div class="line"><span class="comment">#  每次输入间隔0.25秒，输入Hello world!</span></div><div class="line">pyautogui.typewrite(<span class="string">'Hello world!'</span>, interval=<span class="number">0.25</span>)</div></pre></td></tr></table></figure></p>
<h4 id="press-，keyDown-和keyUp-函数"><a href="#press-，keyDown-和keyUp-函数" class="headerlink" title="press()，keyDown()和keyUp()函数"></a>press()，keyDown()和keyUp()函数</h4><p>要按那些功能键，可以用press()函数把<code>pyautogui.KEYBOARD_KEYS</code>里面按键对应的字符串输入进去。例如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#  ENTER键</span></div><div class="line">pyautogui.press(<span class="string">'enter'</span>)</div><div class="line"><span class="comment">#  F1键</span></div><div class="line">pyautogui.press(<span class="string">'f1'</span>)</div><div class="line"><span class="comment">#  左方向键</span></div><div class="line">pyautogui.press(<span class="string">'left'</span>)</div></pre></td></tr></table></figure>
<p>press()函数其实是keyDown()和keyUp()函数的包装，模拟的按下然后松开两个动作。这两个函数可以单独调用。例如，按下shift键的同时按3次左方向键：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#  按下`shift`键</span></div><div class="line">pyautogui.keyDown(<span class="string">'shift'</span>)</div><div class="line">pyautogui.press(<span class="string">'left'</span>)</div><div class="line">pyautogui.press(<span class="string">'left'</span>)</div><div class="line">pyautogui.press(<span class="string">'left'</span>)</div><div class="line"><span class="comment">#  松开`shift`键</span></div><div class="line">pyautogui.keyUp(<span class="string">'shift'</span>)</div></pre></td></tr></table></figure></p>
<p>和typewrite()函数一样，可以用数组把一组键传入press()。例如：<br><code>pyautogui.press([&#39;left&#39;, &#39;left&#39;, &#39;left&#39;])</code></p>
<h4 id="hotkey-函数"><a href="#hotkey-函数" class="headerlink" title="hotkey()函数"></a>hotkey()函数</h4><p>为了更高效的输入热键，PyAutoGUI提供了hotkey()函数来绑定若干按键：<br><code>pyautogui.hotkey(&#39;ctrl&#39;, &#39;shift&#39;, &#39;ese&#39;)</code><br>等价于：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">pyautogui.keyDown(<span class="string">'ctrl'</span>)</div><div class="line">pyautogui.keyDown(<span class="string">'shift'</span>)</div><div class="line">pyautogui.keyDown(<span class="string">'esc'</span>)</div><div class="line">pyautogui.keyUp(<span class="string">'esc'</span>)</div><div class="line">pyautogui.keyUp(<span class="string">'shift'</span>)</div><div class="line">pyautogui.keyUp(<span class="string">'ctrl'</span>)</div></pre></td></tr></table></figure></p>
<h4 id="KEYBOARD-KEYS"><a href="#KEYBOARD-KEYS" class="headerlink" title="KEYBOARD_KEYS"></a>KEYBOARD_KEYS</h4><p>下面就是press()，keyDown()，keyUp()和hotkey()函数可以输入的按键名称：<br><code>print(pyautogui.KEYBOARD_KEYS)</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[&apos;\t&apos;, &apos;\n&apos;, &apos;\r&apos;, &apos; &apos;, &apos;!&apos;, &apos;&quot;&apos;, &apos;#&apos;, &apos;$&apos;, &apos;%&apos;, &apos;&amp;&apos;, &quot;&apos;&quot;, &apos;(&apos;, &apos;)&apos;, &apos;*&apos;, &apos;+&apos;, &apos;,&apos;, &apos;-&apos;, &apos;.&apos;, &apos;/&apos;, &apos;0&apos;, &apos;1&apos;, &apos;2&apos;, &apos;3&apos;, &apos;4&apos;, &apos;5&apos;, &apos;6&apos;, &apos;7&apos;, &apos;8&apos;, &apos;9&apos;, &apos;:&apos;, &apos;;&apos;, &apos;&lt;&apos;, &apos;=&apos;, &apos;&gt;&apos;, &apos;?&apos;, &apos;@&apos;, &apos;[&apos;, &apos;\\&apos;, &apos;]&apos;, &apos;^&apos;, &apos;_&apos;, &apos;`&apos;, &apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;, &apos;f&apos;, &apos;g&apos;, &apos;h&apos;, &apos;i&apos;, &apos;j&apos;, &apos;k&apos;, &apos;l&apos;, &apos;m&apos;, &apos;n&apos;, &apos;o&apos;, &apos;p&apos;, &apos;q&apos;, &apos;r&apos;, &apos;s&apos;, &apos;t&apos;, &apos;u&apos;, &apos;v&apos;, &apos;w&apos;, &apos;x&apos;, &apos;y&apos;, &apos;z&apos;, &apos;&#123;&apos;, &apos;|&apos;, &apos;&#125;&apos;, &apos;~&apos;, &apos;accept&apos;, &apos;add&apos;, &apos;alt&apos;, &apos;altleft&apos;, &apos;altright&apos;, &apos;apps&apos;, &apos;backspace&apos;, &apos;browserback&apos;, &apos;browserfavorites&apos;, &apos;browserforward&apos;, &apos;browserhome&apos;, &apos;browserrefresh&apos;, &apos;browsersearch&apos;, &apos;browserstop&apos;, &apos;capslock&apos;, &apos;clear&apos;, &apos;convert&apos;, &apos;ctrl&apos;, &apos;ctrlleft&apos;, &apos;ctrlright&apos;, &apos;decimal&apos;, &apos;del&apos;, &apos;delete&apos;, &apos;divide&apos;, &apos;down&apos;, &apos;end&apos;, &apos;enter&apos;, &apos;esc&apos;, &apos;escape&apos;, &apos;execute&apos;, &apos;f1&apos;, &apos;f10&apos;, &apos;f11&apos;, &apos;f12&apos;, &apos;f13&apos;, &apos;f14&apos;, &apos;f15&apos;, &apos;f16&apos;, &apos;f17&apos;, &apos;f18&apos;, &apos;f19&apos;, &apos;f2&apos;, &apos;f20&apos;, &apos;f21&apos;, &apos;f22&apos;, &apos;f23&apos;, &apos;f24&apos;, &apos;f3&apos;, &apos;f4&apos;, &apos;f5&apos;, &apos;f6&apos;, &apos;f7&apos;, &apos;f8&apos;, &apos;f9&apos;, &apos;final&apos;, &apos;fn&apos;, &apos;hanguel&apos;, &apos;hangul&apos;, &apos;hanja&apos;, &apos;help&apos;, &apos;home&apos;, &apos;insert&apos;, &apos;junja&apos;, &apos;kana&apos;, &apos;kanji&apos;, &apos;launchapp1&apos;, &apos;launchapp2&apos;, &apos;launchmail&apos;, &apos;launchmediaselect&apos;, &apos;left&apos;, &apos;modechange&apos;, &apos;multiply&apos;, &apos;nexttrack&apos;, &apos;nonconvert&apos;, &apos;num0&apos;, &apos;num1&apos;, &apos;num2&apos;, &apos;num3&apos;, &apos;num4&apos;, &apos;num5&apos;, &apos;num6&apos;, &apos;num7&apos;, &apos;num8&apos;, &apos;num9&apos;, &apos;numlock&apos;, &apos;pagedown&apos;, &apos;pageup&apos;, &apos;pause&apos;, &apos;pgdn&apos;, &apos;pgup&apos;, &apos;playpause&apos;, &apos;prevtrack&apos;, &apos;print&apos;, &apos;printscreen&apos;, &apos;prntscrn&apos;, &apos;prtsc&apos;, &apos;prtscr&apos;, &apos;return&apos;, &apos;right&apos;, &apos;scrolllock&apos;, &apos;select&apos;, &apos;separator&apos;, &apos;shift&apos;, &apos;shiftleft&apos;, &apos;shiftright&apos;, &apos;sleep&apos;, &apos;stop&apos;, &apos;subtract&apos;, &apos;tab&apos;, &apos;up&apos;, &apos;volumedown&apos;, &apos;volumemute&apos;, &apos;volumeup&apos;, &apos;win&apos;, &apos;winleft&apos;, &apos;winright&apos;, &apos;yen&apos;, &apos;command&apos;, &apos;option&apos;, &apos;optionleft&apos;, &apos;optionright&apos;]</div></pre></td></tr></table></figure></p>
<h3 id="消息弹窗函数-1"><a href="#消息弹窗函数-1" class="headerlink" title="消息弹窗函数"></a>消息弹窗函数</h3><p>PyAutoGUI通过Tkinter实现了4种纯Python的消息弹窗函数，和JavaScript类似。</p>
<h4 id="alert-函数"><a href="#alert-函数" class="headerlink" title="alert()函数"></a>alert()函数</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">pyautogui.alert(text=<span class="string">''</span>, title=<span class="string">''</span>, button=<span class="string">'OK'</span>)</div><div class="line"><span class="comment"># 'OK'</span></div></pre></td></tr></table></figure>
<p>显示一个简单的带文字和OK按钮的消息弹窗。用户点击后返回button的文字。</p>
<h4 id="confirm-函数"><a href="#confirm-函数" class="headerlink" title="confirm() 函数"></a>confirm() 函数</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#  OK和Cancel按钮的消息弹窗</span></div><div class="line">pyautogui.confirm(text=<span class="string">''</span>, title=<span class="string">''</span>, buttons=[<span class="string">'OK'</span>, <span class="string">'Cancel'</span>])</div><div class="line"><span class="comment">#  10个按键0-9的消息弹窗</span></div><div class="line">pyautogui.confirm(text=<span class="string">''</span>, title=<span class="string">''</span>, buttons=range(<span class="number">10</span>))</div></pre></td></tr></table></figure>
<p>显示一个简单的带文字、OK和Cancel按钮的消息弹窗，用户点击后返回被点击button的文字，支持自定义数字、文字的列表。</p>
<h4 id="prompt-函数"><a href="#prompt-函数" class="headerlink" title="prompt() 函数"></a>prompt() 函数</h4><p><code>pyautogui.prompt(text=&#39;&#39;, title=&#39;&#39; , default=&#39;&#39;)</code><br>可以输入的消息弹窗，带OK和Cancel按钮。用户点击OK按钮返回输入的文字，点击Cancel按钮返回None。</p>
<h4 id="password-函数"><a href="#password-函数" class="headerlink" title="password() 函数"></a>password() 函数</h4><p><code>pyautogui.password(text=&#39;&#39;, title=&#39;&#39;, default=&#39;&#39;, mask=&#39;*&#39;)</code><br>样式同prompt()，用于输入密码，消息用*表示。带OK和Cancel按钮。用户点击OK按钮返回输入的文字，点击Cancel按钮返回None。</p>
<h3 id="截屏函数-1"><a href="#截屏函数-1" class="headerlink" title="截屏函数"></a>截屏函数</h3><p>PyAutoGUI可以截屏并保存为图片文件，然后定位这些截屏在屏幕上的位置。与sikuli类似，把屏幕上的按键截取下来，然后定位，就可以执行点击等操作了。</p>
<p>截屏功能需要安装Pillow模块。OS X用screencapture命令，是系统自带的。Linux用户用scrot命令，可以通过<code>sudo apt-get install scrot</code>安装。</p>
<h4 id="Ubuntu注意事项"><a href="#Ubuntu注意事项" class="headerlink" title="Ubuntu注意事项"></a>Ubuntu注意事项</h4><p>由于Ubuntu上安装Pillow时缺少PNG和JPEG依赖，所以安装比较复杂，具体可以看Ubuntu论坛。不过用miniconda可以解决这些问题，如果Ubuntu或Mint上安装了miniconda，可以直接<code>conda install pillow</code>来安装。</p>
<h4 id="screenshot-函数"><a href="#screenshot-函数" class="headerlink" title="screenshot()函数"></a>screenshot()函数</h4><p>screenshot()函数会返回Image对象（参考Pillow或PIL模块文档），也可以设置文件名：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> pyautogui</div><div class="line">im1 = pyautogui.screenshot()</div><div class="line">im2 = pyautogui.screenshot(<span class="string">'my_screenshot.png'</span>)</div><div class="line"><span class="comment"># 在一个 1920×10801920×1080 的屏幕上，screenshot()函数要消耗100微秒——不快也不慢。</span></div><div class="line"></div><div class="line"><span class="comment">#如果你不需要截取整个屏幕，还有一个可选的region参数。你可以把截取区域的左上角XY坐标值和宽度、高度传入截取。</span></div><div class="line">im = pyautogui.screenshot(region=(<span class="number">0</span>, <span class="number">0</span>, <span class="number">300</span> ,<span class="number">400</span>))</div></pre></td></tr></table></figure></p>
<h4 id="定位函数"><a href="#定位函数" class="headerlink" title="定位函数"></a>定位函数</h4><p>可以定位截图在屏幕上的坐标位置。比如，你需要在计算器里输入：</p>
<p><img src="/2017/07/27/py-pyautogui-2017-07-27/1.png" alt=""></p>
<p>如果你不知道按钮的位置，就不能用moveTo()定位和click()点击。而且每次计算器的位置可能会变化，这时即使有来坐标也不好用了。但是如果你有要点击按钮的截图，比如数字7：</p>
<p>你可以调用pyautogui.locateOnScreen(‘calc7key.png’)函数来获得7的屏幕坐标。返回的是一个元组(top, left, width, height)。这个元组可以用pyautogui.center()函数来获取截图屏幕的中心坐标。如果截图没找到，pyautogui.locateOnScreen()函数返回None：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> pyautogui</div><div class="line">button7location = pyautogui.locateOnScreen(<span class="string">'pyautogui/calc7key.png'</span>)</div><div class="line">button7location</div><div class="line"><span class="comment"># (1226, 546, 29, 28)</span></div><div class="line">button7x, button7y = pyautogui.center(button7location)</div><div class="line">button7x, button7y</div><div class="line"><span class="comment"># (1240, 560)</span></div><div class="line">pyautogui.click(button7x, button7y)</div></pre></td></tr></table></figure></p>
<p>locateCenterOnScreen()等价于上面的前两布操作，直接获得截屏屏幕中心坐标：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> pyautogui</div><div class="line">x, y = pyautogui.locateCenterOnScreen(<span class="string">'pyautogui/calc7key.png'</span>)</div><div class="line">pyautogui.click(x, y)</div></pre></td></tr></table></figure></p>
<p>在 1920×10801920×1080 的屏幕上，定位函数需要1~2秒时间。对视频游戏（LOL、DOTA）来说就太慢了，但是上班干活还是绰绰有余。</p>
<p>还是几个定位函数。都是从左上角原点开始向右向下搜索截图位置：</p>
<ul>
<li>locateOnScreen(image, grayscale=False)：返回找到的第一个截图Image对象在屏幕上的坐标(left, top, width, height)，如果没找到返回None</li>
<li>locateCenterOnScreen(image, grayscale=False)：返回找到的第一个截图Image对象在屏幕上的中心坐标(x, y)，如果没找到返回None</li>
<li>locateAllOnScreen(image, grayscale=False)：返回找到的所有相同截图Image对象在屏幕上的坐标(left, top, width, height)的生成器</li>
<li>locate(needleImage, haystackImage, grayscale=False)：返回找到的第一个截图Image对象在haystackImage里面的坐标(left, top, width, height)，如果没找到返回None</li>
<li>locateAll(needleImage, haystackImage, grayscale=False)：返回找到的所有相同截图Image对象在haystackImage里面的坐标(left, top, width, height)的生成器</li>
</ul>
<p>两个locateAll*函数都可以用for循环和list()输出：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> pos <span class="keyword">in</span> pyautogui.locateAllOnScreen(<span class="string">'pyautogui/calc7key.png'</span>):</div><div class="line">    print(pos)</div><div class="line"><span class="comment"># (1227, 546, 29, 28)</span></div><div class="line">list(pyautogui.locateAllOnScreen(<span class="string">'pyautogui/calc7key.png'</span>))</div><div class="line"><span class="comment"># [(1227, 546, 29, 28)]</span></div></pre></td></tr></table></figure></p>
<h4 id="灰度值匹配"><a href="#灰度值匹配" class="headerlink" title="灰度值匹配"></a>灰度值匹配</h4><p>可以把grayscale参数设置为True来加速定位（大约提升30%），默认为False。这种去色（desaturate）方法可以加速定位，但是也可能导致假阳性（false-positive）匹配：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> pyautogui</div><div class="line">button7location = pyautogui.locateOnScreen(<span class="string">'pyautogui/calc7key.png'</span>, grayscale=<span class="keyword">True</span>)</div><div class="line">button7location</div><div class="line"><span class="comment"># (1227, 546, 29, 28)</span></div></pre></td></tr></table></figure></p>
<h4 id="像素匹配"><a href="#像素匹配" class="headerlink" title="像素匹配"></a>像素匹配</h4><p>要获取截屏某个位置的RGB像素值，可以用Image对象的getpixel()方法：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> pyautogui</div><div class="line">im = pyautogui.screenshot()</div><div class="line">im.getpixel((<span class="number">100</span>, <span class="number">200</span>))</div><div class="line"><span class="comment"># (255, 255, 255)</span></div><div class="line"><span class="comment"># 也可以用PyAutoGUI的pixel()函数，是之前调用的包装：</span></div><div class="line">pyautogui.pixel(<span class="number">100</span>, <span class="number">200</span>)</div><div class="line"><span class="comment"># (255, 255, 255)</span></div></pre></td></tr></table></figure></p>
<p>如果你只是要检验一下指定位置的像素值，可以用pixelMatchesColor()函数，把X、Y和RGB元组值穿入即可：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">pyautogui.pixelMatchesColor(<span class="number">100</span>, <span class="number">200</span>, (<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>))</div><div class="line"><span class="comment"># True</span></div><div class="line">pyautogui.pixelMatchesColor(<span class="number">100</span>, <span class="number">200</span>, (<span class="number">255</span>, <span class="number">255</span>, <span class="number">245</span>))</div><div class="line"><span class="comment"># False</span></div><div class="line"></div><div class="line"><span class="comment"># tolerance参数可以指定红、绿、蓝3种颜色误差范围：</span></div><div class="line">pyautogui.pixelMatchesColor(<span class="number">100</span>, <span class="number">200</span>, (<span class="number">255</span>, <span class="number">255</span>, <span class="number">245</span>), tolerance=<span class="number">10</span>)</div><div class="line"><span class="comment"># True</span></div><div class="line">pyautogui.pixelMatchesColor(<span class="number">100</span>, <span class="number">200</span>, (<span class="number">248</span>, <span class="number">250</span>, <span class="number">245</span>), tolerance=<span class="number">10</span>)</div><div class="line"><span class="comment"># True</span></div><div class="line">pyautogui.pixelMatchesColor(<span class="number">100</span>, <span class="number">200</span>, (<span class="number">205</span>, <span class="number">255</span>, <span class="number">245</span>), tolerance=<span class="number">10</span>)</div><div class="line"><span class="comment"># False</span></div></pre></td></tr></table></figure></p>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul>
<li><a href="https://muxuezi.github.io/posts/doc-pyautogui.html" target="_blank" rel="external">https://muxuezi.github.io/posts/doc-pyautogui.html</a></li>
</ul>
</div><div class="tags"><a href="/tags/Python/">Python</a></div><div class="post-nav"><a href="/2017/08/02/pyqt-promptplugin-2017-08-02/" class="pre">PyQt5控件提升和插件</a><a href="/2017/07/22/js-this-2017-07-22/" class="next">Javascript之this用法</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Web/">Web</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/js/">js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/node-js/">node.js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/">web</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/工具/">工具</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/思想/">思想</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据库/">数据库</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/编程/">编程</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/随笔/">随笔</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/Markdown/" style="font-size: 15px;">Markdown</a> <a href="/tags/算法/" style="font-size: 15px;">算法</a> <a href="/tags/计算机基础/" style="font-size: 15px;">计算机基础</a> <a href="/tags/谷歌/" style="font-size: 15px;">谷歌</a> <a href="/tags/Python/" style="font-size: 15px;">Python</a> <a href="/tags/C-C/" style="font-size: 15px;">C/C++</a> <a href="/tags/OOP/" style="font-size: 15px;">OOP</a> <a href="/tags/css/" style="font-size: 15px;">css</a> <a href="/tags/设计模式/" style="font-size: 15px;">设计模式</a> <a href="/tags/Flask/" style="font-size: 15px;">Flask</a> <a href="/tags/Git/" style="font-size: 15px;">Git</a> <a href="/tags/Hexo/" style="font-size: 15px;">Hexo</a> <a href="/tags/方法/" style="font-size: 15px;">方法</a> <a href="/tags/HTML/" style="font-size: 15px;">HTML</a> <a href="/tags/http/" style="font-size: 15px;">http</a> <a href="/tags/js/" style="font-size: 15px;">js</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/node-js/" style="font-size: 15px;">node.js</a> <a href="/tags/MongoDB/" style="font-size: 15px;">MongoDB</a> <a href="/tags/MySQL/" style="font-size: 15px;">MySQL</a> <a href="/tags/NodeJS/" style="font-size: 15px;">NodeJS</a> <a href="/tags/Vue/" style="font-size: 15px;">Vue</a> <a href="/tags/NSIS/" style="font-size: 15px;">NSIS</a> <a href="/tags/web/" style="font-size: 15px;">web</a> <a href="/tags/python/" style="font-size: 15px;">python</a> <a href="/tags/scrapy/" style="font-size: 15px;">scrapy</a> <a href="/tags/PyQt5/" style="font-size: 15px;">PyQt5</a> <a href="/tags/RegExp/" style="font-size: 15px;">RegExp</a> <a href="/tags/爬虫/" style="font-size: 15px;">爬虫</a> <a href="/tags/Tools/" style="font-size: 15px;">Tools</a> <a href="/tags/SVN/" style="font-size: 15px;">SVN</a> <a href="/tags/redis/" style="font-size: 15px;">redis</a> <a href="/tags/tornado/" style="font-size: 15px;">tornado</a> <a href="/tags/Web/" style="font-size: 15px;">Web</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/01/15/py-scrapy2-2018-01-15/">scrapy安装</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/15/py-pipcmds-2018-01-15/">python之pip常用命令</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/11/css-note1-2018-01-11/">css笔记1</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/11/selenium-phatomjs-2017-12-11/">selenium-phatomjs使用</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/08/jQuery-notes1-2017-12-08/">jQuery笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/08/js-dom-2017-12-08/">javascript之DOM操作</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/08/appium-notes1-2017-12-08/">Appium笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/08/js-object-2017-12-08/">javascript 标准对象</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/07/selenium-notes1-2017-12-07/">selenium笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/04/js-notes2-2017-12-04/">javascript笔记(二)</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a href="/." rel="nofollow">Simple &amp; Freedom.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.css"><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>