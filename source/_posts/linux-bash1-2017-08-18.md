---
title: linux开机自启
date: 2017-08-18 09:51:19
tags: Linux
categories: 编程
---

### Linux下终端执行自定义命令启动程序
在/usr/bin目录下一般会存放一个shell脚本,然后在终端输入该shell脚本的名字,就会在终端执行这个shell脚本.
```bash
#!/bin/sh
# 搜索进程中touchpanel的进程数目,这里是为了保持脚本执行的单个实例
var=`ps -aux |grep "/usr/bin/touchpanel" |wc -l`
# 注意空格不能少
if [ $var -gt 3 ];then
    exit
fi

cd /opt/touchpanel

sudo python3 main.py $@
```

### Linux下如何开机自启应用程序
编写一个*.desktop文件,然后将该文件放在/etc/xdg/autostart下,然后就会开机自动启动应用程序
```bash
[Desktop Entry]
Type=Application
Icon=
Name=TouchPanel
Comment=xxx
Categories=GNOME;GTK;System;
Exec=touchpanel
StartupNotify=true
Terminal=false
```

### 制作deb安装包
```bash
#!/bin/sh
echo "1. 获取版本号"
version=`awk 'NR==2{print $2}' deb/DEBIAN/control`
echo "version = ${version}"
echo "2. 拷贝资源文件"
mkdir -p deb/opt/pun-admin/res
mkdir -p deb/usr/bin
mkdir -p deb/usr/share/applications
mkdir -p deb/usr/share/pixmaps
cp res/*.ui deb/opt/pun-admin/res/
cp res/config.ini deb/opt/pun-admin/res/
cp res/pun.desktop deb/opt/pun-admin/res/
cp res/pun-admin.desktop deb/usr/share/applications/
cp res/*.png deb/usr/share/pixmaps/
cp res/pun-admin deb/usr/bin/
cp res/touchpanel.desktop deb/opt/pun-admin/res/
cp res/touchpanel deb/usr/bin/
echo "3. 拷贝程序"
cp *.py deb/opt/pun-admin/
echo "4. 添加可执行权限"
chmod +x deb/usr/bin/pun-admin
chmod +x deb/usr/bin/touchpanel
echo "5. dpkg打包"
dpkg-deb --build deb pun-admin-${version}.deb
echo "6. 打包结束"
```