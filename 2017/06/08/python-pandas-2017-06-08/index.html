<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="Learn and live."><title>Python之Pandas入门 | Simple &amp; Freedom</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/7.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Python之Pandas入门</h1><a id="logo" href="/.">Simple &amp; Freedom</a><p class="description">Learn and live.</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/404.html"><i class="fa fa-heartbeat"> 公益404</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Python之Pandas入门</h1><div class="post-meta">Jun 8, 2017<span> | </span><span class="category"><a href="/categories/python/">python</a></span></div><div class="post-content"><p>这是一个简短的为新手入门的pandas教程,更高级的用法请查看<a href="http://pandas.pydata.org/pandas-docs/stable/cookbook.html#cookbook" target="_blank" rel="external">ccokbook</a><br>这里安装numpy, mayplotlit 和 pandas省略.首先导入如下包<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">1</span>]: <span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div><div class="line"></div><div class="line">In [<span class="number">2</span>]: <span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"></div><div class="line">In [<span class="number">3</span>]: <span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div></pre></td></tr></table></figure></p>
<h3 id="对象创建"><a href="#对象创建" class="headerlink" title="对象创建"></a>对象创建</h3><p>传递一个list来创建一个 Series 对象, pandas会自动创建索引<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">4</span>]: s = pd.Series([<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,np.nan, <span class="number">6</span>, <span class="number">8</span>])</div><div class="line"></div><div class="line">In [<span class="number">5</span>]: s</div><div class="line">Out[<span class="number">5</span>]:</div><div class="line"><span class="number">0</span>    <span class="number">1.0</span></div><div class="line"><span class="number">1</span>    <span class="number">3.0</span></div><div class="line"><span class="number">2</span>    <span class="number">5.0</span></div><div class="line"><span class="number">3</span>    NaN</div><div class="line"><span class="number">4</span>    <span class="number">6.0</span></div><div class="line"><span class="number">5</span>    <span class="number">8.0</span></div><div class="line">dtype: float64</div></pre></td></tr></table></figure></p>
<p>传递一个numpy的array创建一个DataFrame对象, 同时以datetime为索引和带label的列<br>DataFrame 是有多个列的数据表，每个列拥有一个 label，当然，DataFrame 也有索引<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 创建datetime索引</span></div><div class="line">In [<span class="number">6</span>]: dates = pd.date_range(<span class="string">'20170608'</span>, periods=<span class="number">6</span>)</div><div class="line"></div><div class="line">In [<span class="number">7</span>]: dates</div><div class="line">Out[<span class="number">7</span>]:</div><div class="line">DatetimeIndex([<span class="string">'2017-06-08'</span>, <span class="string">'2017-06-09'</span>, <span class="string">'2017-06-10'</span>, <span class="string">'2017-06-11'</span>,</div><div class="line">               <span class="string">'2017-06-12'</span>, <span class="string">'2017-06-13'</span>],</div><div class="line">              dtype=<span class="string">'datetime64[ns]'</span>, freq=<span class="string">'D'</span>)</div><div class="line"></div><div class="line">In [<span class="number">8</span>]: df = pd.DataFrame(np.random.randn(<span class="number">6</span>,<span class="number">4</span>), index=dates, columns=list(<span class="string">'ABCD'</span>))</div><div class="line"></div><div class="line">In [<span class="number">9</span>]: df</div><div class="line">Out[<span class="number">9</span>]:</div><div class="line">                   A         B         C         D</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-08</span> <span class="number">-0.561773</span>  <span class="number">0.881191</span> <span class="number">-2.697783</span> <span class="number">-0.034672</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-09</span> <span class="number">-0.053409</span>  <span class="number">0.814811</span>  <span class="number">0.294231</span> <span class="number">-1.753744</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-10</span> <span class="number">-1.699722</span>  <span class="number">0.971518</span> <span class="number">-2.592852</span>  <span class="number">1.088473</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-11</span> <span class="number">-2.411028</span>  <span class="number">0.312229</span> <span class="number">-1.879164</span>  <span class="number">1.388484</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-12</span> <span class="number">-0.173929</span> <span class="number">-0.572149</span>  <span class="number">2.044024</span> <span class="number">-0.101223</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-13</span> <span class="number">-0.906777</span> <span class="number">-0.207889</span> <span class="number">-0.776134</span>  <span class="number">2.327599</span></div></pre></td></tr></table></figure></p>
<p>传递一个dict来创建一个DataFrame, 每个 dict 的 value 会被转化成一个 Series,<br>可以认为，DataFrame 是由多个 Series 组成的<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">10</span>]: df2 = pd.DataFrame(&#123;</div><div class="line">    ...: <span class="string">'A'</span>: <span class="number">1.</span>,</div><div class="line">    ...: <span class="string">'B'</span>: pd.Timestamp(<span class="string">'20170608'</span>),</div><div class="line">    ...: <span class="string">'C'</span>: pd.Series(<span class="number">1</span>, index=list(range(<span class="number">4</span>)), dtype=<span class="string">'float32'</span>),</div><div class="line">    ...: <span class="string">'D'</span>: np.array([<span class="number">3</span>]*<span class="number">4</span>, dtype=<span class="string">'int32'</span>),</div><div class="line">    ...: <span class="string">'E'</span>: pd.Categorical([<span class="string">'test'</span>, <span class="string">'train'</span>, <span class="string">'test'</span>, <span class="string">'train'</span>]),</div><div class="line">    ...: <span class="string">'F'</span>: <span class="string">'foo'</span>&#125;)</div><div class="line"></div><div class="line">In [<span class="number">11</span>]: df2</div><div class="line">Out[<span class="number">11</span>]:</div><div class="line">     A          B    C  D      E    F</div><div class="line"><span class="number">0</span>  <span class="number">1.0</span> <span class="number">2017</span><span class="number">-06</span><span class="number">-08</span>  <span class="number">1.0</span>  <span class="number">3</span>   test  foo</div><div class="line"><span class="number">1</span>  <span class="number">1.0</span> <span class="number">2017</span><span class="number">-06</span><span class="number">-08</span>  <span class="number">1.0</span>  <span class="number">3</span>  train  foo</div><div class="line"><span class="number">2</span>  <span class="number">1.0</span> <span class="number">2017</span><span class="number">-06</span><span class="number">-08</span>  <span class="number">1.0</span>  <span class="number">3</span>   test  foo</div><div class="line"><span class="number">3</span>  <span class="number">1.0</span> <span class="number">2017</span><span class="number">-06</span><span class="number">-08</span>  <span class="number">1.0</span>  <span class="number">3</span>  train  foo</div></pre></td></tr></table></figure></p>
<p>每列数据的格式用 dtypes 查看<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">12</span>]: df2.dtypes</div><div class="line">Out[<span class="number">12</span>]:</div><div class="line">A           float64</div><div class="line">B    datetime64[ns]</div><div class="line">C           float32</div><div class="line">D             int32</div><div class="line">E          category</div><div class="line">F            object</div><div class="line">dtype: object</div></pre></td></tr></table></figure></p>
<h3 id="数据查看"><a href="#数据查看" class="headerlink" title="数据查看"></a>数据查看</h3><p>查看指定列的数据<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">15</span>]: df2.A</div><div class="line">Out[<span class="number">15</span>]:</div><div class="line"><span class="number">0</span>    <span class="number">1.0</span></div><div class="line"><span class="number">1</span>    <span class="number">1.0</span></div><div class="line"><span class="number">2</span>    <span class="number">1.0</span></div><div class="line"><span class="number">3</span>    <span class="number">1.0</span></div><div class="line">Name: A, dtype: float64</div></pre></td></tr></table></figure></p>
<p>用 head 和 tail 查看顶端和底端的几列, <code>head()</code>和<code>tail()</code>函数默认值都是5<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">16</span>]: df.head()                                 </div><div class="line">Out[<span class="number">16</span>]:                                           </div><div class="line">                   A         B         C         D </div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-08</span> <span class="number">-0.561773</span>  <span class="number">0.881191</span> <span class="number">-2.697783</span> <span class="number">-0.034672</span> </div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-09</span> <span class="number">-0.053409</span>  <span class="number">0.814811</span>  <span class="number">0.294231</span> <span class="number">-1.753744</span> </div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-10</span> <span class="number">-1.699722</span>  <span class="number">0.971518</span> <span class="number">-2.592852</span>  <span class="number">1.088473</span> </div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-11</span> <span class="number">-2.411028</span>  <span class="number">0.312229</span> <span class="number">-1.879164</span>  <span class="number">1.388484</span> </div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-12</span> <span class="number">-0.173929</span> <span class="number">-0.572149</span>  <span class="number">2.044024</span> <span class="number">-0.101223</span> </div><div class="line">                                                   </div><div class="line">In [<span class="number">17</span>]: df.tail(<span class="number">3</span>)                                </div><div class="line">Out[<span class="number">17</span>]:                                           </div><div class="line">                   A         B         C         D </div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-11</span> <span class="number">-2.411028</span>  <span class="number">0.312229</span> <span class="number">-1.879164</span>  <span class="number">1.388484</span> </div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-12</span> <span class="number">-0.173929</span> <span class="number">-0.572149</span>  <span class="number">2.044024</span> <span class="number">-0.101223</span> </div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-13</span> <span class="number">-0.906777</span> <span class="number">-0.207889</span> <span class="number">-0.776134</span>  <span class="number">2.327599</span> </div><div class="line">                                                   </div><div class="line">In [<span class="number">18</span>]: df.head(<span class="number">2</span>)                                </div><div class="line">Out[<span class="number">18</span>]:                                           </div><div class="line">                   A         B         C         D </div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-08</span> <span class="number">-0.561773</span>  <span class="number">0.881191</span> <span class="number">-2.697783</span> <span class="number">-0.034672</span> </div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-09</span> <span class="number">-0.053409</span>  <span class="number">0.814811</span>  <span class="number">0.294231</span> <span class="number">-1.753744</span> </div><div class="line">                                                   </div><div class="line">In [<span class="number">19</span>]: df.tail()                                 </div><div class="line">Out[<span class="number">19</span>]:                                           </div><div class="line">                   A         B         C         D </div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-09</span> <span class="number">-0.053409</span>  <span class="number">0.814811</span>  <span class="number">0.294231</span> <span class="number">-1.753744</span> </div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-10</span> <span class="number">-1.699722</span>  <span class="number">0.971518</span> <span class="number">-2.592852</span>  <span class="number">1.088473</span> </div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-11</span> <span class="number">-2.411028</span>  <span class="number">0.312229</span> <span class="number">-1.879164</span>  <span class="number">1.388484</span> </div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-12</span> <span class="number">-0.173929</span> <span class="number">-0.572149</span>  <span class="number">2.044024</span> <span class="number">-0.101223</span> </div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-13</span> <span class="number">-0.906777</span> <span class="number">-0.207889</span> <span class="number">-0.776134</span>  <span class="number">2.327599</span></div></pre></td></tr></table></figure></p>
<p>单独查看 index 和 columns 和 数据, DataFrame 内部用 numpy 格式存储数据<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">20</span>]: df.index</div><div class="line">Out[<span class="number">20</span>]:</div><div class="line">DatetimeIndex([<span class="string">'2017-06-08'</span>, <span class="string">'2017-06-09'</span>, <span class="string">'2017-06-10'</span>, <span class="string">'2017-06-11'</span>,</div><div class="line">               <span class="string">'2017-06-12'</span>, <span class="string">'2017-06-13'</span>],</div><div class="line">              dtype=<span class="string">'datetime64[ns]'</span>, freq=<span class="string">'D'</span>)</div><div class="line"></div><div class="line">In [<span class="number">21</span>]: df.columns</div><div class="line">Out[<span class="number">21</span>]: Index([<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'D'</span>], dtype=<span class="string">'object'</span>)</div><div class="line"></div><div class="line">In [<span class="number">22</span>]: df.values</div><div class="line">Out[<span class="number">22</span>]:</div><div class="line">array([[<span class="number">-0.56177253</span>,  <span class="number">0.88119144</span>, <span class="number">-2.6977834</span> , <span class="number">-0.03467225</span>],</div><div class="line">       [<span class="number">-0.05340873</span>,  <span class="number">0.81481114</span>,  <span class="number">0.29423114</span>, <span class="number">-1.75374372</span>],</div><div class="line">       [<span class="number">-1.69972161</span>,  <span class="number">0.97151768</span>, <span class="number">-2.59285248</span>,  <span class="number">1.08847275</span>],</div><div class="line">       [<span class="number">-2.41102846</span>,  <span class="number">0.3122287</span> , <span class="number">-1.87916396</span>,  <span class="number">1.38848363</span>],</div><div class="line">       [<span class="number">-0.17392908</span>, <span class="number">-0.57214913</span>,  <span class="number">2.04402398</span>, <span class="number">-0.10122313</span>],</div><div class="line">       [<span class="number">-0.90677665</span>, <span class="number">-0.20788934</span>, <span class="number">-0.77613381</span>,  <span class="number">2.32759919</span>]])</div></pre></td></tr></table></figure></p>
<p>describe() 显示数据的概要。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">23</span>]: df.describe()</div><div class="line">Out[<span class="number">23</span>]:</div><div class="line">              A         B         C         D</div><div class="line">count  <span class="number">6.000000</span>  <span class="number">6.000000</span>  <span class="number">6.000000</span>  <span class="number">6.000000</span></div><div class="line">mean  <span class="number">-0.967773</span>  <span class="number">0.366618</span> <span class="number">-0.934613</span>  <span class="number">0.485819</span></div><div class="line">std    <span class="number">0.922339</span>  <span class="number">0.639667</span>  <span class="number">1.852466</span>  <span class="number">1.428378</span></div><div class="line">min   <span class="number">-2.411028</span> <span class="number">-0.572149</span> <span class="number">-2.697783</span> <span class="number">-1.753744</span></div><div class="line"><span class="number">25</span>%   <span class="number">-1.501485</span> <span class="number">-0.077860</span> <span class="number">-2.414430</span> <span class="number">-0.084585</span></div><div class="line"><span class="number">50</span>%   <span class="number">-0.734275</span>  <span class="number">0.563520</span> <span class="number">-1.327649</span>  <span class="number">0.526900</span></div><div class="line"><span class="number">75</span>%   <span class="number">-0.270890</span>  <span class="number">0.864596</span>  <span class="number">0.026640</span>  <span class="number">1.313481</span></div><div class="line">max   <span class="number">-0.053409</span>  <span class="number">0.971518</span>  <span class="number">2.044024</span>  <span class="number">2.327599</span></div></pre></td></tr></table></figure></p>
<p>和 numpy 一样，可以方便的得到转置,就是行列转换<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">24</span>]: df.T</div><div class="line">Out[<span class="number">24</span>]:</div><div class="line">   <span class="number">2017</span><span class="number">-06</span><span class="number">-08</span>  <span class="number">2017</span><span class="number">-06</span><span class="number">-09</span>  <span class="number">2017</span><span class="number">-06</span><span class="number">-10</span>  <span class="number">2017</span><span class="number">-06</span><span class="number">-11</span>  <span class="number">2017</span><span class="number">-06</span><span class="number">-12</span>  <span class="number">2017</span><span class="number">-06</span><span class="number">-13</span></div><div class="line">A   <span class="number">-0.561773</span>   <span class="number">-0.053409</span>   <span class="number">-1.699722</span>   <span class="number">-2.411028</span>   <span class="number">-0.173929</span>   <span class="number">-0.906777</span></div><div class="line">B    <span class="number">0.881191</span>    <span class="number">0.814811</span>    <span class="number">0.971518</span>    <span class="number">0.312229</span>   <span class="number">-0.572149</span>   <span class="number">-0.207889</span></div><div class="line">C   <span class="number">-2.697783</span>    <span class="number">0.294231</span>   <span class="number">-2.592852</span>   <span class="number">-1.879164</span>    <span class="number">2.044024</span>   <span class="number">-0.776134</span></div><div class="line">D   <span class="number">-0.034672</span>   <span class="number">-1.753744</span>    <span class="number">1.088473</span>    <span class="number">1.388484</span>   <span class="number">-0.101223</span>    <span class="number">2.327599</span></div></pre></td></tr></table></figure></p>
<p>对 axis 按照 index 排序（axis=1 是指根据列名来排序, axis=0 是根据行名来排序）<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">26</span>]: df.sort_index(axis=<span class="number">1</span>, ascending=<span class="keyword">False</span>)</div><div class="line">Out[<span class="number">26</span>]:</div><div class="line">                   D         C         B         A</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-08</span> <span class="number">-0.034672</span> <span class="number">-2.697783</span>  <span class="number">0.881191</span> <span class="number">-0.561773</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-09</span> <span class="number">-1.753744</span>  <span class="number">0.294231</span>  <span class="number">0.814811</span> <span class="number">-0.053409</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-10</span>  <span class="number">1.088473</span> <span class="number">-2.592852</span>  <span class="number">0.971518</span> <span class="number">-1.699722</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-11</span>  <span class="number">1.388484</span> <span class="number">-1.879164</span>  <span class="number">0.312229</span> <span class="number">-2.411028</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-12</span> <span class="number">-0.101223</span>  <span class="number">2.044024</span> <span class="number">-0.572149</span> <span class="number">-0.173929</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-13</span>  <span class="number">2.327599</span> <span class="number">-0.776134</span> <span class="number">-0.207889</span> <span class="number">-0.906777</span></div></pre></td></tr></table></figure></p>
<p>按值排序<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">30</span>]: df.sort_values(by=<span class="string">'B'</span>)</div><div class="line">Out[<span class="number">30</span>]:</div><div class="line">                   A         B         C         D</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-12</span> <span class="number">-0.173929</span> <span class="number">-0.572149</span>  <span class="number">2.044024</span> <span class="number">-0.101223</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-13</span> <span class="number">-0.906777</span> <span class="number">-0.207889</span> <span class="number">-0.776134</span>  <span class="number">2.327599</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-11</span> <span class="number">-2.411028</span>  <span class="number">0.312229</span> <span class="number">-1.879164</span>  <span class="number">1.388484</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-09</span> <span class="number">-0.053409</span>  <span class="number">0.814811</span>  <span class="number">0.294231</span> <span class="number">-1.753744</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-08</span> <span class="number">-0.561773</span>  <span class="number">0.881191</span> <span class="number">-2.697783</span> <span class="number">-0.034672</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-10</span> <span class="number">-1.699722</span>  <span class="number">0.971518</span> <span class="number">-2.592852</span>  <span class="number">1.088473</span></div></pre></td></tr></table></figure></p>
<h3 id="选择"><a href="#选择" class="headerlink" title="选择"></a>选择</h3><p><strong>注意:</strong> 以下这些对交互式环境很友好，但是作为 production code 请用优化过的 <code>.at, .iat, .loc, .iloc, .ix</code>等.</p>
<p>获取行/列<br>从 DataFrame 选择一个列，就得到了 Series<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">31</span>]: df[<span class="string">'A'</span>]</div><div class="line">Out[<span class="number">31</span>]:</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-08</span>   <span class="number">-0.561773</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-09</span>   <span class="number">-0.053409</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-10</span>   <span class="number">-1.699722</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-11</span>   <span class="number">-2.411028</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-12</span>   <span class="number">-0.173929</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-13</span>   <span class="number">-0.906777</span></div><div class="line">Freq: D, Name: A, dtype: float64</div></pre></td></tr></table></figure></p>
<p>使用[] 对行切片<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">35</span>]: df[<span class="number">0</span>:<span class="number">3</span>]</div><div class="line">Out[<span class="number">35</span>]:</div><div class="line">                   A         B         C         D</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-08</span> <span class="number">-0.561773</span>  <span class="number">0.881191</span> <span class="number">-2.697783</span> <span class="number">-0.034672</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-09</span> <span class="number">-0.053409</span>  <span class="number">0.814811</span>  <span class="number">0.294231</span> <span class="number">-1.753744</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-10</span> <span class="number">-1.699722</span>  <span class="number">0.971518</span> <span class="number">-2.592852</span>  <span class="number">1.088473</span></div></pre></td></tr></table></figure></p>
<p>通过标签选择<br>通过时间戳的下标（dates[0] = Timestamp(‘20130101’)）来访问<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">36</span>]: df.loc[dates[<span class="number">1</span>]]</div><div class="line">Out[<span class="number">36</span>]:</div><div class="line">A   <span class="number">-0.053409</span></div><div class="line">B    <span class="number">0.814811</span></div><div class="line">C    <span class="number">0.294231</span></div><div class="line">D   <span class="number">-1.753744</span></div><div class="line">Name: <span class="number">2017</span><span class="number">-06</span><span class="number">-09</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>, dtype: float64</div></pre></td></tr></table></figure></p>
<p>选择多个标签<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">38</span>]: df.loc[:,[<span class="string">'A'</span>, <span class="string">'B'</span>]]</div><div class="line">Out[<span class="number">38</span>]:</div><div class="line">                   A         B</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-08</span> <span class="number">-0.561773</span>  <span class="number">0.881191</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-09</span> <span class="number">-0.053409</span>  <span class="number">0.814811</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-10</span> <span class="number">-1.699722</span>  <span class="number">0.971518</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-11</span> <span class="number">-2.411028</span>  <span class="number">0.312229</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-12</span> <span class="number">-0.173929</span> <span class="number">-0.572149</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-13</span> <span class="number">-0.906777</span> <span class="number">-0.207889</span></div></pre></td></tr></table></figure></p>
<p>注意那个冒号，用法和 MATLAB 或 NumPy 是一样的！所以也可以这样<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">39</span>]: df.loc[dates[<span class="number">0</span>]:dates[<span class="number">2</span>], [<span class="string">'A'</span>, <span class="string">'B'</span>]]</div><div class="line">Out[<span class="number">39</span>]:</div><div class="line">                   A         B</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-08</span> <span class="number">-0.561773</span>  <span class="number">0.881191</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-09</span> <span class="number">-0.053409</span>  <span class="number">0.814811</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-10</span> <span class="number">-1.699722</span>  <span class="number">0.971518</span></div></pre></td></tr></table></figure></p>
<p>依旧和 MATLAB 一样，当有一个维度是标量（而不是范围或序列）的时候，选择出的矩阵维度会减少<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">40</span>]: df.loc[dates[<span class="number">0</span>], [<span class="string">'A'</span>, <span class="string">'B'</span>]]</div><div class="line">Out[<span class="number">40</span>]:</div><div class="line">A   <span class="number">-0.561773</span></div><div class="line">B    <span class="number">0.881191</span></div><div class="line">Name: <span class="number">2017</span><span class="number">-06</span><span class="number">-08</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>, dtype: float64</div></pre></td></tr></table></figure></p>
<p>如果对所有的维度都写了标量，不就是选出一个元素吗？<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">41</span>]: df.loc[dates[<span class="number">0</span>], <span class="string">'A'</span>]</div><div class="line">Out[<span class="number">41</span>]: <span class="number">-0.56177252662051747</span></div></pre></td></tr></table></figure></p>
<p>这种情况通常用 at ，速度更快<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">42</span>]: df.at[dates[<span class="number">0</span>], <span class="string">'A'</span>]</div><div class="line">Out[<span class="number">42</span>]: <span class="number">-0.56177252662051747</span></div></pre></td></tr></table></figure></p>
<p>通过位置选择,即整数下标选择, 和 MATLAB 完全一样<br>这个就和数组类似啦，直接看例子。选出第4行：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">43</span>]: df.iloc[<span class="number">3</span>]</div><div class="line">Out[<span class="number">43</span>]:</div><div class="line">A   <span class="number">-2.411028</span></div><div class="line">B    <span class="number">0.312229</span></div><div class="line">C   <span class="number">-1.879164</span></div><div class="line">D    <span class="number">1.388484</span></div><div class="line">Name: <span class="number">2017</span><span class="number">-06</span><span class="number">-11</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>, dtype: float64</div></pre></td></tr></table></figure></p>
<p>选出3~4行，0~1列：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">45</span>]: df.iloc[<span class="number">3</span>:<span class="number">5</span>, <span class="number">0</span>:<span class="number">2</span>]</div><div class="line">Out[<span class="number">45</span>]:</div><div class="line">                   A         B</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-11</span> <span class="number">-2.411028</span>  <span class="number">0.312229</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-12</span> <span class="number">-0.173929</span> <span class="number">-0.572149</span></div></pre></td></tr></table></figure></p>
<p>也能用 list 选择, 挑出指定行和列<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">46</span>]: df.iloc[[<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>], [<span class="number">0</span>, <span class="number">3</span>]]</div><div class="line">Out[<span class="number">46</span>]:</div><div class="line">                   A         D</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-09</span> <span class="number">-0.053409</span> <span class="number">-1.753744</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-10</span> <span class="number">-1.699722</span>  <span class="number">1.088473</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-12</span> <span class="number">-0.173929</span> <span class="number">-0.101223</span></div></pre></td></tr></table></figure></p>
<p>也可以用slice<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">47</span>]: df.iloc[<span class="number">1</span>:<span class="number">3</span>, <span class="number">1</span>:<span class="number">3</span>]</div><div class="line">Out[<span class="number">47</span>]:</div><div class="line">                   B         C</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-09</span>  <span class="number">0.814811</span>  <span class="number">0.294231</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-10</span>  <span class="number">0.971518</span> <span class="number">-2.592852</span></div></pre></td></tr></table></figure></p>
<p>选择单个元素<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">48</span>]: df.iloc[<span class="number">0</span>,<span class="number">0</span>]</div><div class="line">Out[<span class="number">48</span>]: <span class="number">-0.56177252662051747</span></div><div class="line"></div><div class="line">In [<span class="number">49</span>]: df.iat[<span class="number">0</span>,<span class="number">0</span>]</div><div class="line">Out[<span class="number">49</span>]: <span class="number">-0.56177252662051747</span></div></pre></td></tr></table></figure></p>
<h3 id="布尔值索引"><a href="#布尔值索引" class="headerlink" title="布尔值索引"></a>布尔值索引</h3><p>根据单列的值来选择数据<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">7</span>]: df[df.A &gt; <span class="number">0</span>]</div><div class="line">Out[<span class="number">7</span>]:</div><div class="line">                   A         B         C        D</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-13</span>  <span class="number">0.909448</span> <span class="number">-0.302722</span> <span class="number">-2.198783</span> <span class="number">-0.47542</span></div></pre></td></tr></table></figure></p>
<p>从DataFrame中选择符合条件的值, 其中不符合条件的用NaN填充<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">8</span>]: df[df &gt; <span class="number">0</span>]</div><div class="line">Out[<span class="number">8</span>]:</div><div class="line">                   A         B         C         D</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-08</span>       NaN       NaN       NaN       NaN</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-09</span>       NaN  <span class="number">1.297100</span>       NaN  <span class="number">0.231742</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-10</span>       NaN  <span class="number">2.380203</span>       NaN       NaN</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-11</span>       NaN  <span class="number">2.262221</span>  <span class="number">1.135382</span>  <span class="number">1.166144</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-12</span>       NaN       NaN       NaN       NaN</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-13</span>  <span class="number">0.909448</span>       NaN       NaN       NaN</div></pre></td></tr></table></figure></p>
<p>isin() 函数：是否在集合中, 用来过滤数据<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">9</span>]: df2 = df.copy()</div><div class="line"></div><div class="line">In [<span class="number">10</span>]: df2[<span class="string">'E'</span>] = [<span class="string">'one'</span>, <span class="string">'two'</span>, <span class="string">'three'</span>, <span class="string">'four'</span>, <span class="string">'three'</span>, <span class="string">'one'</span>]</div><div class="line"></div><div class="line">In [<span class="number">11</span>]: df2</div><div class="line">Out[<span class="number">11</span>]:</div><div class="line">                   A         B         C         D      E</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-08</span> <span class="number">-0.993188</span> <span class="number">-0.098497</span> <span class="number">-0.898984</span> <span class="number">-0.060261</span>    one</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-09</span> <span class="number">-0.262396</span>  <span class="number">1.297100</span> <span class="number">-0.161798</span>  <span class="number">0.231742</span>    two</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-10</span> <span class="number">-1.792578</span>  <span class="number">2.380203</span> <span class="number">-0.116943</span> <span class="number">-1.486425</span>  three</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-11</span> <span class="number">-2.126554</span>  <span class="number">2.262221</span>  <span class="number">1.135382</span>  <span class="number">1.166144</span>   four</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-12</span> <span class="number">-0.421283</span> <span class="number">-1.725798</span> <span class="number">-0.588929</span> <span class="number">-0.191101</span>  three</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-13</span>  <span class="number">0.909448</span> <span class="number">-0.302722</span> <span class="number">-2.198783</span> <span class="number">-0.475420</span>    one</div><div class="line"></div><div class="line">In [<span class="number">12</span>]: df2[df2[<span class="string">'E'</span>].isin([<span class="string">'two'</span>, <span class="string">'four'</span>])]</div><div class="line">Out[<span class="number">12</span>]:</div><div class="line">                   A         B         C         D     E</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-09</span> <span class="number">-0.262396</span>  <span class="number">1.297100</span> <span class="number">-0.161798</span>  <span class="number">0.231742</span>   two</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-11</span> <span class="number">-2.126554</span>  <span class="number">2.262221</span>  <span class="number">1.135382</span>  <span class="number">1.166144</span>  four</div></pre></td></tr></table></figure></p>
<h3 id="设置-setting"><a href="#设置-setting" class="headerlink" title="设置 setting"></a>设置 setting</h3><p>为 DataFrame 增加新的列，按 index 对应<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">13</span>]: s1 = pd.Series([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>], index=pd.date_range(<span class="string">'20170608'</span>, periods=<span class="number">6</span>))</div><div class="line"></div><div class="line">In [<span class="number">14</span>]: s1</div><div class="line">Out[<span class="number">14</span>]:</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-08</span>    <span class="number">1</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-09</span>    <span class="number">2</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-10</span>    <span class="number">3</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-11</span>    <span class="number">4</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-12</span>    <span class="number">5</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-13</span>    <span class="number">6</span></div><div class="line">Freq: D, dtype: int64</div><div class="line"></div><div class="line">In [<span class="number">15</span>]: df[<span class="string">'F'</span>] = s1</div><div class="line"></div><div class="line">In [<span class="number">16</span>]: df</div><div class="line">Out[<span class="number">16</span>]:</div><div class="line">                   A         B         C         D  F</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-08</span> <span class="number">-0.993188</span> <span class="number">-0.098497</span> <span class="number">-0.898984</span> <span class="number">-0.060261</span>  <span class="number">1</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-09</span> <span class="number">-0.262396</span>  <span class="number">1.297100</span> <span class="number">-0.161798</span>  <span class="number">0.231742</span>  <span class="number">2</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-10</span> <span class="number">-1.792578</span>  <span class="number">2.380203</span> <span class="number">-0.116943</span> <span class="number">-1.486425</span>  <span class="number">3</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-11</span> <span class="number">-2.126554</span>  <span class="number">2.262221</span>  <span class="number">1.135382</span>  <span class="number">1.166144</span>  <span class="number">4</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-12</span> <span class="number">-0.421283</span> <span class="number">-1.725798</span> <span class="number">-0.588929</span> <span class="number">-0.191101</span>  <span class="number">5</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-13</span>  <span class="number">0.909448</span> <span class="number">-0.302722</span> <span class="number">-2.198783</span> <span class="number">-0.475420</span>  <span class="number">6</span></div></pre></td></tr></table></figure></p>
<p>通过label, 下标和numpy数组设置值<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 通过label设置值</span></div><div class="line">In [<span class="number">17</span>]: df.at[dates[<span class="number">0</span>], <span class="string">'A'</span>] = <span class="number">0</span></div><div class="line"><span class="comment"># 通过下标设置值</span></div><div class="line">In [<span class="number">19</span>]: df.iat[<span class="number">0</span>,<span class="number">1</span>] = <span class="number">0</span></div><div class="line"><span class="comment"># 用 numpy 数组设置值</span></div><div class="line">In [<span class="number">21</span>]: df.loc[:, <span class="string">'D'</span>] = np.array([<span class="number">5</span>] * len(df))</div><div class="line">In [<span class="number">23</span>]: df</div><div class="line"></div><div class="line">Out[<span class="number">23</span>]:</div><div class="line">                   A         B         C  D  F</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-08</span>  <span class="number">0.000000</span>  <span class="number">0.000000</span> <span class="number">-0.898984</span>  <span class="number">5</span>  <span class="number">1</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-09</span> <span class="number">-0.262396</span>  <span class="number">1.297100</span> <span class="number">-0.161798</span>  <span class="number">5</span>  <span class="number">2</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-10</span> <span class="number">-1.792578</span>  <span class="number">2.380203</span> <span class="number">-0.116943</span>  <span class="number">5</span>  <span class="number">3</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-11</span> <span class="number">-2.126554</span>  <span class="number">2.262221</span>  <span class="number">1.135382</span>  <span class="number">5</span>  <span class="number">4</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-12</span> <span class="number">-0.421283</span> <span class="number">-1.725798</span> <span class="number">-0.588929</span>  <span class="number">5</span>  <span class="number">5</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-13</span>  <span class="number">0.909448</span> <span class="number">-0.302722</span> <span class="number">-2.198783</span>  <span class="number">5</span>  <span class="number">6</span></div></pre></td></tr></table></figure></p>
<p>通过布尔值设置值<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">28</span>]: df[df&gt;<span class="number">0</span>] = -df</div><div class="line"></div><div class="line">In [<span class="number">29</span>]: df</div><div class="line">Out[<span class="number">29</span>]:</div><div class="line">                   A         B         C  D  F</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-08</span>  <span class="number">0.000000</span>  <span class="number">0.000000</span> <span class="number">-0.898984</span> <span class="number">-5</span> <span class="number">-1</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-09</span> <span class="number">-0.262396</span> <span class="number">-1.297100</span> <span class="number">-0.161798</span> <span class="number">-5</span> <span class="number">-2</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-10</span> <span class="number">-1.792578</span> <span class="number">-2.380203</span> <span class="number">-0.116943</span> <span class="number">-5</span> <span class="number">-3</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-11</span> <span class="number">-2.126554</span> <span class="number">-2.262221</span> <span class="number">-1.135382</span> <span class="number">-5</span> <span class="number">-4</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-12</span> <span class="number">-0.421283</span> <span class="number">-1.725798</span> <span class="number">-0.588929</span> <span class="number">-5</span> <span class="number">-5</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-13</span> <span class="number">-0.909448</span> <span class="number">-0.302722</span> <span class="number">-2.198783</span> <span class="number">-5</span> <span class="number">-6</span></div></pre></td></tr></table></figure></p>
<h3 id="缺失值"><a href="#缺失值" class="headerlink" title="缺失值"></a>缺失值</h3><p>pandas 用 np.nan 表示缺失值。通常它不会被计算。<br>Reindexing 允许你改变/增加/删除 指定轴的index, 并返回数据的拷贝<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">30</span>]: df1 = df.reindex(index=dates[<span class="number">0</span>:<span class="number">4</span>], columns=list(df.columns) + [<span class="string">'E'</span>])</div><div class="line"></div><div class="line">In [<span class="number">31</span>]: df1.loc[dates[<span class="number">0</span>]:dates[<span class="number">1</span>], <span class="string">'E'</span>] = <span class="number">1</span></div><div class="line"></div><div class="line">In [<span class="number">32</span>]: df1</div><div class="line">Out[<span class="number">32</span>]:</div><div class="line">                   A         B         C  D  F    E</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-08</span>  <span class="number">0.000000</span>  <span class="number">0.000000</span> <span class="number">-0.898984</span> <span class="number">-5</span> <span class="number">-1</span>  <span class="number">1.0</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-09</span> <span class="number">-0.262396</span> <span class="number">-1.297100</span> <span class="number">-0.161798</span> <span class="number">-5</span> <span class="number">-2</span>  <span class="number">1.0</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-10</span> <span class="number">-1.792578</span> <span class="number">-2.380203</span> <span class="number">-0.116943</span> <span class="number">-5</span> <span class="number">-3</span>  NaN</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-11</span> <span class="number">-2.126554</span> <span class="number">-2.262221</span> <span class="number">-1.135382</span> <span class="number">-5</span> <span class="number">-4</span>  NaN</div></pre></td></tr></table></figure></p>
<p>丢弃有NaN的行<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">33</span>]: df1.dropna()  <span class="comment"># 或者 df1.dropna(how='any')</span></div><div class="line">Out[<span class="number">33</span>]:</div><div class="line">                   A       B         C  D  F    E</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-08</span>  <span class="number">0.000000</span>  <span class="number">0.0000</span> <span class="number">-0.898984</span> <span class="number">-5</span> <span class="number">-1</span>  <span class="number">1.0</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-09</span> <span class="number">-0.262396</span> <span class="number">-1.2971</span> <span class="number">-0.161798</span> <span class="number">-5</span> <span class="number">-2</span>  <span class="number">1.0</span></div></pre></td></tr></table></figure></p>
<p>填充缺失值<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">35</span>]: df1.fillna(value=<span class="number">5</span>)</div><div class="line">Out[<span class="number">35</span>]:</div><div class="line">                   A         B         C  D  F    E</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-08</span>  <span class="number">0.000000</span>  <span class="number">0.000000</span> <span class="number">-0.898984</span> <span class="number">-5</span> <span class="number">-1</span>  <span class="number">1.0</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-09</span> <span class="number">-0.262396</span> <span class="number">-1.297100</span> <span class="number">-0.161798</span> <span class="number">-5</span> <span class="number">-2</span>  <span class="number">1.0</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-10</span> <span class="number">-1.792578</span> <span class="number">-2.380203</span> <span class="number">-0.116943</span> <span class="number">-5</span> <span class="number">-3</span>  <span class="number">5.0</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-11</span> <span class="number">-2.126554</span> <span class="number">-2.262221</span> <span class="number">-1.135382</span> <span class="number">-5</span> <span class="number">-4</span>  <span class="number">5.0</span></div></pre></td></tr></table></figure></p>
<p>获取布尔值的 mask：哪些值是 NaN, 则为true,否则为false<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">36</span>]: pd.isnull(df1)</div><div class="line">Out[<span class="number">36</span>]:</div><div class="line">                A      B      C      D      F      E</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-08</span>  <span class="keyword">False</span>  <span class="keyword">False</span>  <span class="keyword">False</span>  <span class="keyword">False</span>  <span class="keyword">False</span>  <span class="keyword">False</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-09</span>  <span class="keyword">False</span>  <span class="keyword">False</span>  <span class="keyword">False</span>  <span class="keyword">False</span>  <span class="keyword">False</span>  <span class="keyword">False</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-10</span>  <span class="keyword">False</span>  <span class="keyword">False</span>  <span class="keyword">False</span>  <span class="keyword">False</span>  <span class="keyword">False</span>   <span class="keyword">True</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-11</span>  <span class="keyword">False</span>  <span class="keyword">False</span>  <span class="keyword">False</span>  <span class="keyword">False</span>  <span class="keyword">False</span>   <span class="keyword">True</span></div><div class="line"></div><div class="line">In [<span class="number">37</span>]: df1</div><div class="line">Out[<span class="number">37</span>]:</div><div class="line">                   A         B         C  D  F    E</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-08</span>  <span class="number">0.000000</span>  <span class="number">0.000000</span> <span class="number">-0.898984</span> <span class="number">-5</span> <span class="number">-1</span>  <span class="number">1.0</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-09</span> <span class="number">-0.262396</span> <span class="number">-1.297100</span> <span class="number">-0.161798</span> <span class="number">-5</span> <span class="number">-2</span>  <span class="number">1.0</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-10</span> <span class="number">-1.792578</span> <span class="number">-2.380203</span> <span class="number">-0.116943</span> <span class="number">-5</span> <span class="number">-3</span>  NaN</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-11</span> <span class="number">-2.126554</span> <span class="number">-2.262221</span> <span class="number">-1.135382</span> <span class="number">-5</span> <span class="number">-4</span>  NaN</div></pre></td></tr></table></figure></p>
<p><strong>注意:</strong> 这里的df1数据其实没有改变, 返回的是运算后的数据拷贝</p>
<h3 id="操作"><a href="#操作" class="headerlink" title="操作"></a>操作</h3><p>说明: 操作都会把NaN(缺失值)排除在外</p>
<h4 id="统计"><a href="#统计" class="headerlink" title="统计"></a>统计</h4><p>平均值<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 对每一列做平均值</span></div><div class="line">In [<span class="number">38</span>]: df.mean() <span class="comment"># df.mean(0)</span></div><div class="line">Out[<span class="number">38</span>]:</div><div class="line">A   <span class="number">-0.918710</span></div><div class="line">B   <span class="number">-1.328007</span></div><div class="line">C   <span class="number">-0.850137</span></div><div class="line">D   <span class="number">-5.000000</span></div><div class="line">F   <span class="number">-3.500000</span></div><div class="line">dtype: float64</div><div class="line"></div><div class="line"><span class="comment"># 对每一行做平均值</span></div><div class="line">In [<span class="number">40</span>]: df.mean(<span class="number">1</span>)</div><div class="line">Out[<span class="number">40</span>]:</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-08</span>   <span class="number">-1.379797</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-09</span>   <span class="number">-1.744259</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-10</span>   <span class="number">-2.457945</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-11</span>   <span class="number">-2.904831</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-12</span>   <span class="number">-2.547202</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-13</span>   <span class="number">-2.882190</span></div><div class="line">Freq: D, dtype: float64</div></pre></td></tr></table></figure></p>
<p>操作具有不同维度的对象需要对齐。pandas会沿着指定的维度自动广播<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">42</span>]: s = pd.Series([<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, np.nan, <span class="number">6</span>, <span class="number">8</span>], index=dates).shift(<span class="number">2</span>)</div><div class="line"></div><div class="line">In [<span class="number">43</span>]: s</div><div class="line">Out[<span class="number">43</span>]:</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-08</span>    NaN</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-09</span>    NaN</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-10</span>    <span class="number">1.0</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-11</span>    <span class="number">3.0</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-12</span>    <span class="number">5.0</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-13</span>    NaN</div><div class="line">Freq: D, dtype: float64</div><div class="line"></div><div class="line">In [<span class="number">45</span>]: df.sub(s, axis=<span class="string">'index'</span>)</div><div class="line">Out[<span class="number">45</span>]:</div><div class="line">                   A         B         C     D     F</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-08</span>       NaN       NaN       NaN   NaN   NaN</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-09</span>       NaN       NaN       NaN   NaN   NaN</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-10</span> <span class="number">-2.792578</span> <span class="number">-3.380203</span> <span class="number">-1.116943</span>  <span class="number">-6.0</span>  <span class="number">-4.0</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-11</span> <span class="number">-5.126554</span> <span class="number">-5.262221</span> <span class="number">-4.135382</span>  <span class="number">-8.0</span>  <span class="number">-7.0</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-12</span> <span class="number">-5.421283</span> <span class="number">-6.725798</span> <span class="number">-5.588929</span> <span class="number">-10.0</span> <span class="number">-10.0</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-13</span>       NaN       NaN       NaN   NaN   NaN</div><div class="line"></div><div class="line">In [<span class="number">46</span>]: df</div><div class="line">Out[<span class="number">46</span>]:</div><div class="line">                   A         B         C  D  F</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-08</span>  <span class="number">0.000000</span>  <span class="number">0.000000</span> <span class="number">-0.898984</span> <span class="number">-5</span> <span class="number">-1</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-09</span> <span class="number">-0.262396</span> <span class="number">-1.297100</span> <span class="number">-0.161798</span> <span class="number">-5</span> <span class="number">-2</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-10</span> <span class="number">-1.792578</span> <span class="number">-2.380203</span> <span class="number">-0.116943</span> <span class="number">-5</span> <span class="number">-3</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-11</span> <span class="number">-2.126554</span> <span class="number">-2.262221</span> <span class="number">-1.135382</span> <span class="number">-5</span> <span class="number">-4</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-12</span> <span class="number">-0.421283</span> <span class="number">-1.725798</span> <span class="number">-0.588929</span> <span class="number">-5</span> <span class="number">-5</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-13</span> <span class="number">-0.909448</span> <span class="number">-0.302722</span> <span class="number">-2.198783</span> <span class="number">-5</span> <span class="number">-6</span></div></pre></td></tr></table></figure></p>
<h3 id="Apply"><a href="#Apply" class="headerlink" title="Apply"></a>Apply</h3><p>对数据（行或列） Apply 函数<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">47</span>]: df.apply(np.cumsum)</div><div class="line">Out[<span class="number">47</span>]:</div><div class="line">                   A         B         C   D   F</div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-08</span>  <span class="number">0.000000</span>  <span class="number">0.000000</span> <span class="number">-0.898984</span>  <span class="number">-5</span>  <span class="number">-1</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-09</span> <span class="number">-0.262396</span> <span class="number">-1.297100</span> <span class="number">-1.060782</span> <span class="number">-10</span>  <span class="number">-3</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-10</span> <span class="number">-2.054974</span> <span class="number">-3.677303</span> <span class="number">-1.177726</span> <span class="number">-15</span>  <span class="number">-6</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-11</span> <span class="number">-4.181527</span> <span class="number">-5.939523</span> <span class="number">-2.313108</span> <span class="number">-20</span> <span class="number">-10</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-12</span> <span class="number">-4.602811</span> <span class="number">-7.665321</span> <span class="number">-2.902037</span> <span class="number">-25</span> <span class="number">-15</span></div><div class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-13</span> <span class="number">-5.512259</span> <span class="number">-7.968043</span> <span class="number">-5.100820</span> <span class="number">-30</span> <span class="number">-21</span></div><div class="line"></div><div class="line">In [<span class="number">48</span>]: df.apply(<span class="keyword">lambda</span> x: x.max() -x.min())</div><div class="line">Out[<span class="number">48</span>]:</div><div class="line">A    <span class="number">2.126554</span></div><div class="line">B    <span class="number">2.380203</span></div><div class="line">C    <span class="number">2.081839</span></div><div class="line">D    <span class="number">0.000000</span></div><div class="line">F    <span class="number">5.000000</span></div><div class="line">dtype: float64</div></pre></td></tr></table></figure></p>
<h3 id="直方图"><a href="#直方图" class="headerlink" title="直方图"></a>直方图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">49</span>]: s = pd.Series(np.random.randint(<span class="number">0</span>, <span class="number">7</span>, size=<span class="number">10</span>))</div><div class="line"></div><div class="line">In [<span class="number">50</span>]: s</div><div class="line">Out[<span class="number">50</span>]:</div><div class="line"><span class="number">0</span>    <span class="number">0</span></div><div class="line"><span class="number">1</span>    <span class="number">4</span></div><div class="line"><span class="number">2</span>    <span class="number">6</span></div><div class="line"><span class="number">3</span>    <span class="number">2</span></div><div class="line"><span class="number">4</span>    <span class="number">6</span></div><div class="line"><span class="number">5</span>    <span class="number">6</span></div><div class="line"><span class="number">6</span>    <span class="number">0</span></div><div class="line"><span class="number">7</span>    <span class="number">0</span></div><div class="line"><span class="number">8</span>    <span class="number">3</span></div><div class="line"><span class="number">9</span>    <span class="number">1</span></div><div class="line">dtype: int32</div><div class="line"></div><div class="line">In [<span class="number">52</span>]: s.value_counts()     </div><div class="line">Out[<span class="number">52</span>]:                      </div><div class="line"><span class="number">6</span>    <span class="number">3</span>                        </div><div class="line"><span class="number">0</span>    <span class="number">3</span>                        </div><div class="line"><span class="number">4</span>    <span class="number">1</span>                        </div><div class="line"><span class="number">3</span>    <span class="number">1</span>                        </div><div class="line"><span class="number">2</span>    <span class="number">1</span>                        </div><div class="line"><span class="number">1</span>    <span class="number">1</span>                        </div><div class="line">dtype: int64</div></pre></td></tr></table></figure>
<h3 id="字符串方法"><a href="#字符串方法" class="headerlink" title="字符串方法"></a>字符串方法</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">53</span>]: s = pd.Series([<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'Aaba'</span>, <span class="string">'Baca'</span>, np.nan, <span class="string">'CABA'</span>, <span class="string">'dog'</span>, <span class="string">'cat'</span>])</div><div class="line"></div><div class="line">In [<span class="number">54</span>]: s.str.lower()</div><div class="line">Out[<span class="number">54</span>]:</div><div class="line"><span class="number">0</span>       a</div><div class="line"><span class="number">1</span>       b</div><div class="line"><span class="number">2</span>       c</div><div class="line"><span class="number">3</span>    aaba</div><div class="line"><span class="number">4</span>    baca</div><div class="line"><span class="number">5</span>     NaN</div><div class="line"><span class="number">6</span>    caba</div><div class="line"><span class="number">7</span>     dog</div><div class="line"><span class="number">8</span>     cat</div><div class="line">dtype: object</div></pre></td></tr></table></figure>
<h3 id="Merge"><a href="#Merge" class="headerlink" title="Merge"></a>Merge</h3><h4 id="concat"><a href="#concat" class="headerlink" title="concat"></a>concat</h4><p>简单地按行拼接<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">55</span>]: df = pd.DataFrame(np.random.randn(<span class="number">10</span>, <span class="number">4</span>))</div><div class="line"></div><div class="line">In [<span class="number">56</span>]: df</div><div class="line">Out[<span class="number">56</span>]:</div><div class="line">          <span class="number">0</span>         <span class="number">1</span>         <span class="number">2</span>         <span class="number">3</span></div><div class="line"><span class="number">0</span>  <span class="number">1.279835</span>  <span class="number">0.488299</span>  <span class="number">0.122145</span>  <span class="number">1.066159</span></div><div class="line"><span class="number">1</span> <span class="number">-0.566047</span> <span class="number">-0.625790</span> <span class="number">-0.941786</span> <span class="number">-0.209994</span></div><div class="line"><span class="number">2</span>  <span class="number">0.364785</span>  <span class="number">1.185549</span> <span class="number">-0.381762</span>  <span class="number">1.752895</span></div><div class="line"><span class="number">3</span> <span class="number">-0.568627</span> <span class="number">-0.235160</span> <span class="number">-1.602423</span>  <span class="number">0.603979</span></div><div class="line"><span class="number">4</span>  <span class="number">0.698751</span> <span class="number">-1.656823</span> <span class="number">-0.306150</span>  <span class="number">2.019342</span></div><div class="line"><span class="number">5</span> <span class="number">-0.423725</span>  <span class="number">1.321606</span>  <span class="number">0.894416</span> <span class="number">-0.249282</span></div><div class="line"><span class="number">6</span> <span class="number">-0.125866</span> <span class="number">-2.315650</span>  <span class="number">0.376551</span>  <span class="number">1.050506</span></div><div class="line"><span class="number">7</span> <span class="number">-0.189071</span> <span class="number">-0.933617</span> <span class="number">-0.051930</span> <span class="number">-0.375252</span></div><div class="line"><span class="number">8</span>  <span class="number">0.478909</span> <span class="number">-2.041329</span>  <span class="number">1.217890</span> <span class="number">-1.020701</span></div><div class="line"><span class="number">9</span> <span class="number">-1.287622</span> <span class="number">-0.173968</span>  <span class="number">0.387218</span> <span class="number">-0.004477</span></div><div class="line"></div><div class="line"><span class="comment"># 拆分成piece</span></div><div class="line">In [<span class="number">57</span>]: pieces = [df[:<span class="number">3</span>], df[<span class="number">3</span>:<span class="number">7</span>], df[<span class="number">7</span>:]]</div><div class="line"></div><div class="line">In [<span class="number">58</span>]: pieces</div><div class="line">Out[<span class="number">58</span>]:</div><div class="line">[          <span class="number">0</span>         <span class="number">1</span>         <span class="number">2</span>         <span class="number">3</span></div><div class="line"> <span class="number">0</span>  <span class="number">1.279835</span>  <span class="number">0.488299</span>  <span class="number">0.122145</span>  <span class="number">1.066159</span></div><div class="line"> <span class="number">1</span> <span class="number">-0.566047</span> <span class="number">-0.625790</span> <span class="number">-0.941786</span> <span class="number">-0.209994</span></div><div class="line"> <span class="number">2</span>  <span class="number">0.364785</span>  <span class="number">1.185549</span> <span class="number">-0.381762</span>  <span class="number">1.752895</span>,</div><div class="line">           <span class="number">0</span>         <span class="number">1</span>         <span class="number">2</span>         <span class="number">3</span></div><div class="line"> <span class="number">3</span> <span class="number">-0.568627</span> <span class="number">-0.235160</span> <span class="number">-1.602423</span>  <span class="number">0.603979</span></div><div class="line"> <span class="number">4</span>  <span class="number">0.698751</span> <span class="number">-1.656823</span> <span class="number">-0.306150</span>  <span class="number">2.019342</span></div><div class="line"> <span class="number">5</span> <span class="number">-0.423725</span>  <span class="number">1.321606</span>  <span class="number">0.894416</span> <span class="number">-0.249282</span></div><div class="line"> <span class="number">6</span> <span class="number">-0.125866</span> <span class="number">-2.315650</span>  <span class="number">0.376551</span>  <span class="number">1.050506</span>,</div><div class="line">           <span class="number">0</span>         <span class="number">1</span>         <span class="number">2</span>         <span class="number">3</span></div><div class="line"> <span class="number">7</span> <span class="number">-0.189071</span> <span class="number">-0.933617</span> <span class="number">-0.051930</span> <span class="number">-0.375252</span></div><div class="line"> <span class="number">8</span>  <span class="number">0.478909</span> <span class="number">-2.041329</span>  <span class="number">1.217890</span> <span class="number">-1.020701</span></div><div class="line"> <span class="number">9</span> <span class="number">-1.287622</span> <span class="number">-0.173968</span>  <span class="number">0.387218</span> <span class="number">-0.004477</span>]</div><div class="line"></div><div class="line">In [<span class="number">59</span>]: pd.concat(pieces)</div><div class="line">Out[<span class="number">59</span>]:</div><div class="line">          <span class="number">0</span>         <span class="number">1</span>         <span class="number">2</span>         <span class="number">3</span></div><div class="line"><span class="number">0</span>  <span class="number">1.279835</span>  <span class="number">0.488299</span>  <span class="number">0.122145</span>  <span class="number">1.066159</span></div><div class="line"><span class="number">1</span> <span class="number">-0.566047</span> <span class="number">-0.625790</span> <span class="number">-0.941786</span> <span class="number">-0.209994</span></div><div class="line"><span class="number">2</span>  <span class="number">0.364785</span>  <span class="number">1.185549</span> <span class="number">-0.381762</span>  <span class="number">1.752895</span></div><div class="line"><span class="number">3</span> <span class="number">-0.568627</span> <span class="number">-0.235160</span> <span class="number">-1.602423</span>  <span class="number">0.603979</span></div><div class="line"><span class="number">4</span>  <span class="number">0.698751</span> <span class="number">-1.656823</span> <span class="number">-0.306150</span>  <span class="number">2.019342</span></div><div class="line"><span class="number">5</span> <span class="number">-0.423725</span>  <span class="number">1.321606</span>  <span class="number">0.894416</span> <span class="number">-0.249282</span></div><div class="line"><span class="number">6</span> <span class="number">-0.125866</span> <span class="number">-2.315650</span>  <span class="number">0.376551</span>  <span class="number">1.050506</span></div><div class="line"><span class="number">7</span> <span class="number">-0.189071</span> <span class="number">-0.933617</span> <span class="number">-0.051930</span> <span class="number">-0.375252</span></div><div class="line"><span class="number">8</span>  <span class="number">0.478909</span> <span class="number">-2.041329</span>  <span class="number">1.217890</span> <span class="number">-1.020701</span></div><div class="line"><span class="number">9</span> <span class="number">-1.287622</span> <span class="number">-0.173968</span>  <span class="number">0.387218</span> <span class="number">-0.004477</span></div></pre></td></tr></table></figure></p>
<h4 id="join"><a href="#join" class="headerlink" title="join"></a>join</h4><p>和 SQL 的 join 是一个意思<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">60</span>]: left = pd.DataFrame(&#123;<span class="string">'key'</span>: [<span class="string">'foo'</span>, <span class="string">'foo'</span>], <span class="string">'lval'</span>: [<span class="number">1</span>, <span class="number">2</span>]&#125;)</div><div class="line"></div><div class="line">In [<span class="number">61</span>]: right = pd.DataFrame(&#123;<span class="string">'key'</span>: [<span class="string">'foo'</span>, <span class="string">'foo'</span>], <span class="string">'rval'</span>: [<span class="number">4</span>, <span class="number">5</span>]&#125;)</div><div class="line"></div><div class="line">In [<span class="number">62</span>]: left</div><div class="line">Out[<span class="number">62</span>]:</div><div class="line">   key  lval</div><div class="line"><span class="number">0</span>  foo     <span class="number">1</span></div><div class="line"><span class="number">1</span>  foo     <span class="number">2</span></div><div class="line"></div><div class="line">In [<span class="number">63</span>]: right</div><div class="line">Out[<span class="number">63</span>]:</div><div class="line">   key  rval</div><div class="line"><span class="number">0</span>  foo     <span class="number">4</span></div><div class="line"><span class="number">1</span>  foo     <span class="number">5</span></div><div class="line"></div><div class="line">In [<span class="number">64</span>]: pd.merge(left, right, on=<span class="string">'key'</span>)</div><div class="line">Out[<span class="number">64</span>]:</div><div class="line">   key  lval  rval</div><div class="line"><span class="number">0</span>  foo     <span class="number">1</span>     <span class="number">4</span></div><div class="line"><span class="number">1</span>  foo     <span class="number">1</span>     <span class="number">5</span></div><div class="line"><span class="number">2</span>  foo     <span class="number">2</span>     <span class="number">4</span></div><div class="line"><span class="number">3</span>  foo     <span class="number">2</span>     <span class="number">5</span></div></pre></td></tr></table></figure></p>
<h4 id="Append"><a href="#Append" class="headerlink" title="Append"></a>Append</h4><p>向 DataFrame 增加新的<strong>数据行</strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">65</span>]: df = pd.DataFrame(np.random.randn(<span class="number">8</span>, <span class="number">4</span>), columns=[<span class="string">'A'</span>,<span class="string">'B'</span>,<span class="string">'C'</span>,<span class="string">'D'</span>])</div><div class="line"></div><div class="line">In [<span class="number">66</span>]: df</div><div class="line">Out[<span class="number">66</span>]:</div><div class="line">          A         B         C         D</div><div class="line"><span class="number">0</span> <span class="number">-0.303120</span>  <span class="number">0.419378</span>  <span class="number">0.111816</span> <span class="number">-0.160104</span></div><div class="line"><span class="number">1</span>  <span class="number">0.924466</span>  <span class="number">2.385372</span> <span class="number">-1.575671</span> <span class="number">-1.789283</span></div><div class="line"><span class="number">2</span>  <span class="number">1.106048</span> <span class="number">-0.087699</span>  <span class="number">1.714677</span> <span class="number">-0.058831</span></div><div class="line"><span class="number">3</span>  <span class="number">0.765727</span>  <span class="number">0.101523</span> <span class="number">-1.204472</span>  <span class="number">0.011180</span></div><div class="line"><span class="number">4</span> <span class="number">-2.084695</span> <span class="number">-0.517287</span> <span class="number">-0.497699</span>  <span class="number">0.153516</span></div><div class="line"><span class="number">5</span> <span class="number">-0.252460</span>  <span class="number">0.044590</span> <span class="number">-0.481047</span>  <span class="number">0.617817</span></div><div class="line"><span class="number">6</span> <span class="number">-0.121789</span> <span class="number">-1.663595</span> <span class="number">-0.464836</span> <span class="number">-0.858457</span></div><div class="line"><span class="number">7</span> <span class="number">-0.246298</span>  <span class="number">0.687569</span> <span class="number">-2.081519</span> <span class="number">-1.529134</span></div><div class="line"></div><div class="line">In [<span class="number">67</span>]: s = df.iloc[<span class="number">3</span>]</div><div class="line"></div><div class="line">In [<span class="number">68</span>]: df.append(s, ignore_index=<span class="keyword">True</span>)</div><div class="line">Out[<span class="number">68</span>]:</div><div class="line">          A         B         C         D</div><div class="line"><span class="number">0</span> <span class="number">-0.303120</span>  <span class="number">0.419378</span>  <span class="number">0.111816</span> <span class="number">-0.160104</span></div><div class="line"><span class="number">1</span>  <span class="number">0.924466</span>  <span class="number">2.385372</span> <span class="number">-1.575671</span> <span class="number">-1.789283</span></div><div class="line"><span class="number">2</span>  <span class="number">1.106048</span> <span class="number">-0.087699</span>  <span class="number">1.714677</span> <span class="number">-0.058831</span></div><div class="line"><span class="number">3</span>  <span class="number">0.765727</span>  <span class="number">0.101523</span> <span class="number">-1.204472</span>  <span class="number">0.011180</span></div><div class="line"><span class="number">4</span> <span class="number">-2.084695</span> <span class="number">-0.517287</span> <span class="number">-0.497699</span>  <span class="number">0.153516</span></div><div class="line"><span class="number">5</span> <span class="number">-0.252460</span>  <span class="number">0.044590</span> <span class="number">-0.481047</span>  <span class="number">0.617817</span></div><div class="line"><span class="number">6</span> <span class="number">-0.121789</span> <span class="number">-1.663595</span> <span class="number">-0.464836</span> <span class="number">-0.858457</span></div><div class="line"><span class="number">7</span> <span class="number">-0.246298</span>  <span class="number">0.687569</span> <span class="number">-2.081519</span> <span class="number">-1.529134</span></div><div class="line"><span class="number">8</span>  <span class="number">0.765727</span>  <span class="number">0.101523</span> <span class="number">-1.204472</span>  <span class="number">0.011180</span></div></pre></td></tr></table></figure></p>
<h4 id="Grouping"><a href="#Grouping" class="headerlink" title="Grouping"></a>Grouping</h4><p>和 SQL 中的 GROUP BY 类似，包括以下这几步：</p>
<ul>
<li>根据某些规则，把数据分组</li>
<li>对每组应用一个函数</li>
<li>合并结果到一个数据结构中</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">69</span>]: df = pd.DataFrame(&#123;</div><div class="line">    ...: <span class="string">'A'</span> : [<span class="string">'foo'</span>, <span class="string">'bar'</span>, <span class="string">'foo'</span>, <span class="string">'bar'</span>,<span class="string">'foo'</span>, <span class="string">'bar'</span>, <span class="string">'foo'</span>, <span class="string">'foo'</span>],</div><div class="line">    ...: <span class="string">'B'</span> : [<span class="string">'one'</span>, <span class="string">'one'</span>, <span class="string">'two'</span>, <span class="string">'three'</span>,<span class="string">'two'</span>, <span class="string">'two'</span>, <span class="string">'one'</span>, <span class="string">'three'</span>],</div><div class="line">    ...: <span class="string">'C'</span> : np.random.randn(<span class="number">8</span>),</div><div class="line">    ...: <span class="string">'D'</span> : np.random.randn(<span class="number">8</span>)&#125;)</div><div class="line"></div><div class="line">In [<span class="number">70</span>]: df</div><div class="line">Out[<span class="number">70</span>]:</div><div class="line">     A      B         C         D</div><div class="line"><span class="number">0</span>  foo    one <span class="number">-1.203566</span> <span class="number">-1.199038</span></div><div class="line"><span class="number">1</span>  bar    one  <span class="number">2.368016</span> <span class="number">-1.059656</span></div><div class="line"><span class="number">2</span>  foo    two <span class="number">-0.704544</span> <span class="number">-1.047794</span></div><div class="line"><span class="number">3</span>  bar  three <span class="number">-0.511092</span>  <span class="number">1.121859</span></div><div class="line"><span class="number">4</span>  foo    two <span class="number">-0.723414</span> <span class="number">-1.225536</span></div><div class="line"><span class="number">5</span>  bar    two <span class="number">-0.363631</span>  <span class="number">0.111177</span></div><div class="line"><span class="number">6</span>  foo    one  <span class="number">0.271759</span>  <span class="number">0.500798</span></div><div class="line"><span class="number">7</span>  foo  three <span class="number">-0.248960</span>  <span class="number">2.035166</span></div><div class="line"></div><div class="line"><span class="comment"># 做 Group 操作并对每组求和</span></div><div class="line">In [<span class="number">71</span>]: df.groupby(<span class="string">'A'</span>).sum()</div><div class="line">Out[<span class="number">71</span>]:</div><div class="line">            C         D</div><div class="line">A</div><div class="line">bar  <span class="number">1.493293</span>  <span class="number">0.173380</span></div><div class="line">foo <span class="number">-2.608725</span> <span class="number">-0.936404</span></div><div class="line"></div><div class="line"><span class="comment"># 可以对两列进行 Group by 并求和</span></div><div class="line">In [<span class="number">72</span>]: df.groupby([<span class="string">'A'</span>, <span class="string">'B'</span>]).sum()</div><div class="line">Out[<span class="number">72</span>]:</div><div class="line">                  C         D</div><div class="line">A   B</div><div class="line">bar one    <span class="number">2.368016</span> <span class="number">-1.059656</span></div><div class="line">    three <span class="number">-0.511092</span>  <span class="number">1.121859</span></div><div class="line">    two   <span class="number">-0.363631</span>  <span class="number">0.111177</span></div><div class="line">foo one   <span class="number">-0.931807</span> <span class="number">-0.698240</span></div><div class="line">    three <span class="number">-0.248960</span>  <span class="number">2.035166</span></div><div class="line">    two   <span class="number">-1.427958</span> <span class="number">-2.273330</span></div></pre></td></tr></table></figure>
<h3 id="Reshape"><a href="#Reshape" class="headerlink" title="Reshape"></a>Reshape</h3><h4 id="Stack-叠层"><a href="#Stack-叠层" class="headerlink" title="Stack 叠层"></a>Stack 叠层</h4><p>准备数据<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">73</span>]: tuples = list(zip(*[[<span class="string">'bar'</span>, <span class="string">'bar'</span>, <span class="string">'baz'</span>, <span class="string">'baz'</span>,</div><div class="line">    ...: <span class="string">'foo'</span>, <span class="string">'foo'</span>, <span class="string">'qux'</span>, <span class="string">'qux'</span>],</div><div class="line">    ...: [<span class="string">'one'</span>, <span class="string">'two'</span>, <span class="string">'one'</span>, <span class="string">'two'</span>,</div><div class="line">    ...: <span class="string">'one'</span>, <span class="string">'two'</span>, <span class="string">'one'</span>, <span class="string">'two'</span>]]))</div><div class="line"></div><div class="line">In [<span class="number">75</span>]: index = pd.MultiIndex.from_tuples(tuples, names=[<span class="string">'first'</span>, <span class="string">'second'</span>])</div><div class="line"></div><div class="line">In [<span class="number">76</span>]: df = pd.DataFrame(np.random.randn(<span class="number">8</span>, <span class="number">2</span>), index=index, columns=[<span class="string">'A'</span>,<span class="string">'B'</span>])</div><div class="line"></div><div class="line">In [<span class="number">77</span>]: df2 = df[:<span class="number">4</span>]</div><div class="line"></div><div class="line">In [<span class="number">78</span>]: df2</div><div class="line">Out[<span class="number">78</span>]:</div><div class="line">                     A         B</div><div class="line">first second</div><div class="line">bar   one     <span class="number">0.181096</span> <span class="number">-0.610853</span></div><div class="line">      two    <span class="number">-1.326709</span>  <span class="number">0.269153</span></div><div class="line">baz   one    <span class="number">-0.455180</span> <span class="number">-0.070055</span></div><div class="line">      two    <span class="number">-0.953993</span> <span class="number">-0.235160</span></div><div class="line">```      </div><div class="line"></div><div class="line">stack() 把 DataFrame 的所有列“压缩”到 index 里去</div><div class="line">```python</div><div class="line">In [<span class="number">79</span>]: stacked = df2.stack()</div><div class="line"></div><div class="line">In [<span class="number">80</span>]: stacked</div><div class="line">Out[<span class="number">80</span>]:</div><div class="line">first  second</div><div class="line">bar    one     A    <span class="number">0.181096</span></div><div class="line">               B   <span class="number">-0.610853</span></div><div class="line">       two     A   <span class="number">-1.326709</span></div><div class="line">               B    <span class="number">0.269153</span></div><div class="line">baz    one     A   <span class="number">-0.455180</span></div><div class="line">               B   <span class="number">-0.070055</span></div><div class="line">       two     A   <span class="number">-0.953993</span></div><div class="line">               B   <span class="number">-0.235160</span></div><div class="line">dtype: float64</div></pre></td></tr></table></figure></p>
<p>反之，只要是 MultiIndex 都可以用 unstack() 恢复出列，默认把最后一个 index 解开<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">81</span>]: stacked.unstack()</div><div class="line">Out[<span class="number">81</span>]:</div><div class="line">                     A         B</div><div class="line">first second</div><div class="line">bar   one     <span class="number">0.181096</span> <span class="number">-0.610853</span></div><div class="line">      two    <span class="number">-1.326709</span>  <span class="number">0.269153</span></div><div class="line">baz   one    <span class="number">-0.455180</span> <span class="number">-0.070055</span></div><div class="line">      two    <span class="number">-0.953993</span> <span class="number">-0.235160</span></div><div class="line"></div><div class="line">In [<span class="number">82</span>]: stacked.unstack(<span class="number">1</span>)</div><div class="line">Out[<span class="number">82</span>]:</div><div class="line">second        one       two</div><div class="line">first</div><div class="line">bar   A  <span class="number">0.181096</span> <span class="number">-1.326709</span></div><div class="line">      B <span class="number">-0.610853</span>  <span class="number">0.269153</span></div><div class="line">baz   A <span class="number">-0.455180</span> <span class="number">-0.953993</span></div><div class="line">      B <span class="number">-0.070055</span> <span class="number">-0.235160</span></div><div class="line"></div><div class="line">In [<span class="number">83</span>]: stacked.unstack(<span class="number">0</span>)</div><div class="line">Out[<span class="number">83</span>]:</div><div class="line">first          bar       baz</div><div class="line">second</div><div class="line">one    A  <span class="number">0.181096</span> <span class="number">-0.455180</span></div><div class="line">       B <span class="number">-0.610853</span> <span class="number">-0.070055</span></div><div class="line">two    A <span class="number">-1.326709</span> <span class="number">-0.953993</span></div><div class="line">       B  <span class="number">0.269153</span> <span class="number">-0.235160</span></div></pre></td></tr></table></figure></p>
<h3 id="Pivot-Table-旋转"><a href="#Pivot-Table-旋转" class="headerlink" title="Pivot Table 旋转"></a>Pivot Table 旋转</h3><p>准备数据<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">84</span>]: df = pd.DataFrame(&#123;<span class="string">'A'</span> : [<span class="string">'one'</span>, <span class="string">'one'</span>, <span class="string">'two'</span>, <span class="string">'three'</span>] * <span class="number">3</span>,</div><div class="line">    ...:  <span class="string">'B'</span> : [<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>] * <span class="number">4</span>,</div><div class="line">    ...: <span class="string">'C'</span> : [<span class="string">'foo'</span>, <span class="string">'foo'</span>, <span class="string">'foo'</span>, <span class="string">'bar'</span>, <span class="string">'bar'</span>, <span class="string">'bar'</span>] * <span class="number">2</span>,</div><div class="line">    ...: <span class="string">'D'</span> : np.random.randn(<span class="number">12</span>),</div><div class="line">    ...: <span class="string">'E'</span> : np.random.randn(<span class="number">12</span>)&#125;)</div><div class="line"></div><div class="line">In [<span class="number">85</span>]: df</div><div class="line">Out[<span class="number">85</span>]:</div><div class="line">        A  B    C         D         E</div><div class="line"><span class="number">0</span>     one  A  foo <span class="number">-0.379428</span> <span class="number">-0.050681</span></div><div class="line"><span class="number">1</span>     one  B  foo  <span class="number">1.650807</span>  <span class="number">0.024530</span></div><div class="line"><span class="number">2</span>     two  C  foo  <span class="number">0.349554</span>  <span class="number">1.202692</span></div><div class="line"><span class="number">3</span>   three  A  bar <span class="number">-1.516381</span> <span class="number">-0.163382</span></div><div class="line"><span class="number">4</span>     one  B  bar  <span class="number">0.360722</span> <span class="number">-0.241622</span></div><div class="line"><span class="number">5</span>     one  C  bar <span class="number">-0.276398</span>  <span class="number">0.581192</span></div><div class="line"><span class="number">6</span>     two  A  foo  <span class="number">0.304563</span> <span class="number">-0.663271</span></div><div class="line"><span class="number">7</span>   three  B  foo  <span class="number">1.328499</span>  <span class="number">0.485223</span></div><div class="line"><span class="number">8</span>     one  C  foo  <span class="number">1.665213</span> <span class="number">-0.577843</span></div><div class="line"><span class="number">9</span>     one  A  bar <span class="number">-0.229248</span> <span class="number">-0.335329</span></div><div class="line"><span class="number">10</span>    two  B  bar <span class="number">-0.133112</span>  <span class="number">1.119350</span></div><div class="line"><span class="number">11</span>  three  C  bar <span class="number">-0.383992</span>  <span class="number">0.787800</span></div></pre></td></tr></table></figure></p>
<p>pivot 是把原来的数据(values)作为新表的行(index)、列(columns)<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">86</span>]: pd.pivot_table(df, values=<span class="string">'D'</span>, index=[<span class="string">'A'</span>, <span class="string">'B'</span>], columns=[<span class="string">'C'</span>])</div><div class="line">Out[<span class="number">86</span>]:</div><div class="line">C             bar       foo</div><div class="line">A     B</div><div class="line">one   A <span class="number">-0.229248</span> <span class="number">-0.379428</span></div><div class="line">      B  <span class="number">0.360722</span>  <span class="number">1.650807</span></div><div class="line">      C <span class="number">-0.276398</span>  <span class="number">1.665213</span></div><div class="line">three A <span class="number">-1.516381</span>       NaN</div><div class="line">      B       NaN  <span class="number">1.328499</span></div><div class="line">      C <span class="number">-0.383992</span>       NaN</div><div class="line">two   A       NaN  <span class="number">0.304563</span></div><div class="line">      B <span class="number">-0.133112</span>       NaN</div><div class="line">      C       NaN  <span class="number">0.349554</span></div></pre></td></tr></table></figure></p>
<h3 id="时间序列"><a href="#时间序列" class="headerlink" title="时间序列"></a>时间序列</h3><p>pandas 的时间序列功能在金融应用中很有用。</p>
<p>resample功能<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">88</span>]: rng = pd.date_range(<span class="string">'9/6/2017'</span>, periods=<span class="number">100</span>, freq=<span class="string">'S'</span>)</div><div class="line"></div><div class="line">In [<span class="number">89</span>]: ts = pd.Series(np.random.randint(<span class="number">0</span>, <span class="number">500</span>, len(rng)), index=rng)</div><div class="line"></div><div class="line">In [<span class="number">90</span>]: ts.resample(<span class="string">'5Min'</span>).sum()</div><div class="line">Out[<span class="number">90</span>]:</div><div class="line"><span class="number">2017</span><span class="number">-09</span><span class="number">-06</span>    <span class="number">26085</span></div><div class="line">Freq: <span class="number">5</span>T, dtype: int32</div></pre></td></tr></table></figure></p>
<p>时区表示<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">94</span>]: rng = pd.date_range(<span class="string">'9/6/2017 00:00'</span>, periods=<span class="number">5</span>, freq=<span class="string">'D'</span>)</div><div class="line"></div><div class="line">In [<span class="number">95</span>]: ts = pd.Series(np.random.randn(len(rng)), rng)</div><div class="line"></div><div class="line">In [<span class="number">96</span>]: ts</div><div class="line">Out[<span class="number">96</span>]:</div><div class="line"><span class="number">2017</span><span class="number">-09</span><span class="number">-06</span>   <span class="number">-0.715837</span></div><div class="line"><span class="number">2017</span><span class="number">-09</span><span class="number">-07</span>    <span class="number">1.021448</span></div><div class="line"><span class="number">2017</span><span class="number">-09</span><span class="number">-08</span>    <span class="number">1.186508</span></div><div class="line"><span class="number">2017</span><span class="number">-09</span><span class="number">-09</span>    <span class="number">0.606852</span></div><div class="line"><span class="number">2017</span><span class="number">-09</span><span class="number">-10</span>    <span class="number">0.566530</span></div><div class="line">Freq: D, dtype: float64</div><div class="line"></div><div class="line">In [<span class="number">97</span>]: ts_utc = ts.tz_localize(<span class="string">'UTC'</span>)</div><div class="line"></div><div class="line">In [<span class="number">98</span>]: ts_utc</div><div class="line">Out[<span class="number">98</span>]:</div><div class="line"><span class="number">2017</span><span class="number">-09</span><span class="number">-06</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>+<span class="number">00</span>:<span class="number">00</span>   <span class="number">-0.715837</span></div><div class="line"><span class="number">2017</span><span class="number">-09</span><span class="number">-07</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>+<span class="number">00</span>:<span class="number">00</span>    <span class="number">1.021448</span></div><div class="line"><span class="number">2017</span><span class="number">-09</span><span class="number">-08</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>+<span class="number">00</span>:<span class="number">00</span>    <span class="number">1.186508</span></div><div class="line"><span class="number">2017</span><span class="number">-09</span><span class="number">-09</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>+<span class="number">00</span>:<span class="number">00</span>    <span class="number">0.606852</span></div><div class="line"><span class="number">2017</span><span class="number">-09</span><span class="number">-10</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>+<span class="number">00</span>:<span class="number">00</span>    <span class="number">0.566530</span></div><div class="line">Freq: D, dtype: float64</div></pre></td></tr></table></figure></p>
<p>时区转换<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">100</span>]: ts_utc.tz_convert(<span class="string">'US/Eastern'</span>)</div><div class="line">Out[<span class="number">100</span>]:</div><div class="line"><span class="number">2017</span><span class="number">-09</span><span class="number">-05</span> <span class="number">20</span>:<span class="number">00</span>:<span class="number">00</span><span class="number">-04</span>:<span class="number">00</span>   <span class="number">-0.715837</span></div><div class="line"><span class="number">2017</span><span class="number">-09</span><span class="number">-06</span> <span class="number">20</span>:<span class="number">00</span>:<span class="number">00</span><span class="number">-04</span>:<span class="number">00</span>    <span class="number">1.021448</span></div><div class="line"><span class="number">2017</span><span class="number">-09</span><span class="number">-07</span> <span class="number">20</span>:<span class="number">00</span>:<span class="number">00</span><span class="number">-04</span>:<span class="number">00</span>    <span class="number">1.186508</span></div><div class="line"><span class="number">2017</span><span class="number">-09</span><span class="number">-08</span> <span class="number">20</span>:<span class="number">00</span>:<span class="number">00</span><span class="number">-04</span>:<span class="number">00</span>    <span class="number">0.606852</span></div><div class="line"><span class="number">2017</span><span class="number">-09</span><span class="number">-09</span> <span class="number">20</span>:<span class="number">00</span>:<span class="number">00</span><span class="number">-04</span>:<span class="number">00</span>    <span class="number">0.566530</span></div><div class="line">Freq: D, dtype: float64</div></pre></td></tr></table></figure></p>
<p>在时间跨度表示之间进行转换<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">101</span>]: rng = pd.date_range(<span class="string">'9/6/2017'</span>, periods=<span class="number">5</span>, freq=<span class="string">'M'</span>)</div><div class="line"></div><div class="line">In [<span class="number">102</span>]: ts = pd.Series(np.random.randn(len(rng)), index=rng)</div><div class="line"></div><div class="line">In [<span class="number">103</span>]: ts</div><div class="line">Out[<span class="number">103</span>]:</div><div class="line"><span class="number">2017</span><span class="number">-09</span><span class="number">-30</span>   <span class="number">-0.337867</span></div><div class="line"><span class="number">2017</span><span class="number">-10</span><span class="number">-31</span>    <span class="number">0.546883</span></div><div class="line"><span class="number">2017</span><span class="number">-11</span><span class="number">-30</span>    <span class="number">0.063004</span></div><div class="line"><span class="number">2017</span><span class="number">-12</span><span class="number">-31</span>    <span class="number">0.419636</span></div><div class="line"><span class="number">2018</span><span class="number">-01</span><span class="number">-31</span>    <span class="number">2.562404</span></div><div class="line">Freq: M, dtype: float64</div><div class="line"></div><div class="line">In [<span class="number">104</span>]: ps = ts.to_period()</div><div class="line"></div><div class="line">In [<span class="number">105</span>]: ps</div><div class="line">Out[<span class="number">105</span>]:</div><div class="line"><span class="number">2017</span><span class="number">-09</span>   <span class="number">-0.337867</span></div><div class="line"><span class="number">2017</span><span class="number">-10</span>    <span class="number">0.546883</span></div><div class="line"><span class="number">2017</span><span class="number">-11</span>    <span class="number">0.063004</span></div><div class="line"><span class="number">2017</span><span class="number">-12</span>    <span class="number">0.419636</span></div><div class="line"><span class="number">2018</span><span class="number">-01</span>    <span class="number">2.562404</span></div><div class="line">Freq: M, dtype: float64</div><div class="line"></div><div class="line">In [<span class="number">106</span>]: ps.to_timestamp()</div><div class="line">Out[<span class="number">106</span>]:</div><div class="line"><span class="number">2017</span><span class="number">-09</span><span class="number">-01</span>   <span class="number">-0.337867</span></div><div class="line"><span class="number">2017</span><span class="number">-10</span><span class="number">-01</span>    <span class="number">0.546883</span></div><div class="line"><span class="number">2017</span><span class="number">-11</span><span class="number">-01</span>    <span class="number">0.063004</span></div><div class="line"><span class="number">2017</span><span class="number">-12</span><span class="number">-01</span>    <span class="number">0.419636</span></div><div class="line"><span class="number">2018</span><span class="number">-01</span><span class="number">-01</span>    <span class="number">2.562404</span></div><div class="line">Freq: MS, dtype: float64</div><div class="line"></div><div class="line">In [<span class="number">107</span>]: prng = pd.period_range(<span class="string">'1990Q1'</span>, <span class="string">'2000Q4'</span>, freq=<span class="string">'Q-NOV'</span>)</div><div class="line"></div><div class="line">In [<span class="number">108</span>]: ts = pd.Series(np.random.randn(len(prng)), prng)</div><div class="line"></div><div class="line">In [<span class="number">109</span>]: ts.index = (prng.asfreq(<span class="string">'M'</span>, <span class="string">'e'</span>) + <span class="number">1</span>).asfreq(<span class="string">'H'</span>, <span class="string">'s'</span>) + <span class="number">9</span></div><div class="line"></div><div class="line">In [<span class="number">110</span>]: ts.head()</div><div class="line">Out[<span class="number">110</span>]:</div><div class="line"><span class="number">1990</span><span class="number">-03</span><span class="number">-01</span> <span class="number">09</span>:<span class="number">00</span>   <span class="number">-0.315663</span></div><div class="line"><span class="number">1990</span><span class="number">-06</span><span class="number">-01</span> <span class="number">09</span>:<span class="number">00</span>    <span class="number">2.092510</span></div><div class="line"><span class="number">1990</span><span class="number">-09</span><span class="number">-01</span> <span class="number">09</span>:<span class="number">00</span>    <span class="number">0.337302</span></div><div class="line"><span class="number">1990</span><span class="number">-12</span><span class="number">-01</span> <span class="number">09</span>:<span class="number">00</span>    <span class="number">0.037893</span></div><div class="line"><span class="number">1991</span><span class="number">-03</span><span class="number">-01</span> <span class="number">09</span>:<span class="number">00</span>    <span class="number">0.463572</span></div><div class="line">Freq: H, dtype: float64</div></pre></td></tr></table></figure></p>
<h3 id="类别"><a href="#类别" class="headerlink" title="类别"></a>类别</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">111</span>]: df = pd.DataFrame(&#123;<span class="string">"id"</span>:[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>], <span class="string">"raw_grade"</span>:[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'b'</span>, <span class="string">'a'</span>, <span class="string">'a'</span>, <span class="string">'e'</span>]&#125;)</div><div class="line"></div><div class="line">In [<span class="number">112</span>]: df</div><div class="line">Out[<span class="number">112</span>]:</div><div class="line">   id raw_grade</div><div class="line"><span class="number">0</span>   <span class="number">1</span>         a</div><div class="line"><span class="number">1</span>   <span class="number">2</span>         b</div><div class="line"><span class="number">2</span>   <span class="number">3</span>         b</div><div class="line"><span class="number">3</span>   <span class="number">4</span>         a</div><div class="line"><span class="number">4</span>   <span class="number">5</span>         a</div><div class="line"><span class="number">5</span>   <span class="number">6</span>         e</div><div class="line"></div><div class="line">In [<span class="number">113</span>]: df[<span class="string">'grade'</span>] = df[<span class="string">'raw_grade'</span>].astype(<span class="string">'category'</span>)</div><div class="line"></div><div class="line">In [<span class="number">114</span>]: df[<span class="string">'grade'</span>]</div><div class="line">Out[<span class="number">114</span>]:</div><div class="line"><span class="number">0</span>    a</div><div class="line"><span class="number">1</span>    b</div><div class="line"><span class="number">2</span>    b</div><div class="line"><span class="number">3</span>    a</div><div class="line"><span class="number">4</span>    a</div><div class="line"><span class="number">5</span>    e</div><div class="line">Name: grade, dtype: category</div><div class="line">Categories (<span class="number">3</span>, object): [a, b, e]</div></pre></td></tr></table></figure>
<p>类别可以 inplace 地赋值：（只是改一下对应的字符串嘛，类别是用 Index 对象存储的）<br><code>In [115]: df[&#39;grade&#39;].cat.categories = [&quot;very good&quot;, &quot;good&quot;, &quot;very bad&quot;]</code><br>修改类别时，如果有新的类别，会自动加进去<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">117</span>]: df[<span class="string">'grade'</span>] = df[<span class="string">'grade'</span>].cat.set_categories([<span class="string">"very bad"</span>, <span class="string">"bad"</span>, <span class="string">"medium"</span>, <span class="string">"good"</span>, <span class="string">"very good"</span>])</div><div class="line"></div><div class="line">In [<span class="number">118</span>]: df[<span class="string">'grade'</span>]</div><div class="line">Out[<span class="number">118</span>]:</div><div class="line"><span class="number">0</span>    very good</div><div class="line"><span class="number">1</span>         good</div><div class="line"><span class="number">2</span>         good</div><div class="line"><span class="number">3</span>    very good</div><div class="line"><span class="number">4</span>    very good</div><div class="line"><span class="number">5</span>     very bad</div><div class="line">Name: grade, dtype: category</div><div class="line">Categories (<span class="number">5</span>, object): [very bad, bad, medium, good, very good]</div></pre></td></tr></table></figure></p>
<p>根据类别排序<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">119</span>]: df.sort_values(by=<span class="string">'grade'</span>)</div><div class="line">Out[<span class="number">119</span>]:</div><div class="line">   id raw_grade      grade</div><div class="line"><span class="number">5</span>   <span class="number">6</span>         e   very bad</div><div class="line"><span class="number">1</span>   <span class="number">2</span>         b       good</div><div class="line"><span class="number">2</span>   <span class="number">3</span>         b       good</div><div class="line"><span class="number">0</span>   <span class="number">1</span>         a  very good</div><div class="line"><span class="number">3</span>   <span class="number">4</span>         a  very good</div><div class="line"><span class="number">4</span>   <span class="number">5</span>         a  very good</div></pre></td></tr></table></figure></p>
<p>做 group by 的时候，空的类别也会被呈现出来<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">120</span>]: df.groupby(<span class="string">'grade'</span>).size()</div><div class="line">Out[<span class="number">120</span>]:</div><div class="line">grade</div><div class="line">very bad     <span class="number">1</span></div><div class="line">bad          <span class="number">0</span></div><div class="line">medium       <span class="number">0</span></div><div class="line">good         <span class="number">2</span></div><div class="line">very good    <span class="number">3</span></div><div class="line">dtype: int64</div></pre></td></tr></table></figure></p>
<h3 id="绘图"><a href="#绘图" class="headerlink" title="绘图"></a>绘图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">121</span>]: ts = pd.Series(np.random.randn(<span class="number">1000</span>), index=pd.date_range(<span class="string">'1/1/2000'</span>, periods=<span class="number">1000</span>))</div><div class="line"></div><div class="line">In [<span class="number">122</span>]: ts = ts.cumsum()</div><div class="line"></div><div class="line">In [<span class="number">123</span>]: ts.plot()</div><div class="line">Out[<span class="number">123</span>]: &lt;matplotlib.axes._subplots.AxesSubplot at <span class="number">0x6a0be10</span>&gt;</div></pre></td></tr></table></figure>
<p><img src="/2017/06/08/python-pandas-2017-06-08/1.png" alt=""></p>
<p>对于DtaFrame,可以直接plot<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">124</span>]: df = pd.DataFrame(np.random.randn(<span class="number">1000</span>, <span class="number">4</span>), index=ts.index, columns=[<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'D'</span>])</div><div class="line"></div><div class="line">In [<span class="number">125</span>]: df = df.cumsum()</div><div class="line"></div><div class="line">In [<span class="number">126</span>]: plt.figure(); df.plot(); plt.legend(loc=<span class="string">'best'</span>)</div><div class="line">Out[<span class="number">126</span>]: &lt;matplotlib.legend.Legend at <span class="number">0x6c3e8f0</span>&gt;</div></pre></td></tr></table></figure></p>
<p><img src="/2017/06/08/python-pandas-2017-06-08/2.png" alt=""></p>
<h3 id="读写数据"><a href="#读写数据" class="headerlink" title="读写数据"></a>读写数据</h3><h4 id="CSV"><a href="#CSV" class="headerlink" title="CSV"></a>CSV</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">127</span>]: df.to_csv(<span class="string">'foo.csv'</span>)                            </div><div class="line">                                                          </div><div class="line">In [<span class="number">128</span>]: pd.read_csv(<span class="string">'foo.csv'</span>)                          </div><div class="line">Out[<span class="number">128</span>]:                                                 </div><div class="line">     Unnamed: <span class="number">0</span>         A         B          C          D </div><div class="line"><span class="number">0</span>    <span class="number">2000</span><span class="number">-01</span><span class="number">-01</span>  <span class="number">1.239452</span>  <span class="number">1.983851</span>   <span class="number">0.578987</span>   <span class="number">1.155658</span> </div><div class="line"><span class="number">1</span>    <span class="number">2000</span><span class="number">-01</span><span class="number">-02</span>  <span class="number">0.295568</span>  <span class="number">3.704782</span>   <span class="number">1.962402</span>   <span class="number">0.885559</span> </div><div class="line"><span class="number">2</span>    <span class="number">2000</span><span class="number">-01</span><span class="number">-03</span> <span class="number">-0.139800</span>  <span class="number">3.872238</span>   <span class="number">2.793025</span>   <span class="number">0.972079</span> </div><div class="line"><span class="number">3</span>    <span class="number">2000</span><span class="number">-01</span><span class="number">-04</span> <span class="number">-0.804336</span>  <span class="number">3.259410</span>   <span class="number">2.159552</span>   <span class="number">1.785479</span> </div><div class="line"><span class="number">4</span>    <span class="number">2000</span><span class="number">-01</span><span class="number">-05</span>  <span class="number">0.171984</span>  <span class="number">3.027446</span>   <span class="number">2.253854</span>   <span class="number">0.779544</span> </div><div class="line"><span class="number">5</span>    <span class="number">2000</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">1.781807</span>  <span class="number">1.836517</span>   <span class="number">4.558960</span>   <span class="number">1.999731</span> </div><div class="line"><span class="number">6</span>    <span class="number">2000</span><span class="number">-01</span><span class="number">-07</span>  <span class="number">0.650927</span>  <span class="number">0.154262</span>   <span class="number">3.650160</span>   <span class="number">0.685396</span> </div><div class="line"><span class="number">7</span>    <span class="number">2000</span><span class="number">-01</span><span class="number">-08</span>  <span class="number">0.492898</span> <span class="number">-0.198763</span>   <span class="number">3.646034</span>  <span class="number">-0.073848</span> </div><div class="line"><span class="number">8</span>    <span class="number">2000</span><span class="number">-01</span><span class="number">-09</span> <span class="number">-0.100468</span> <span class="number">-0.623716</span>   <span class="number">3.217366</span>   <span class="number">0.220008</span> </div><div class="line"><span class="number">9</span>    <span class="number">2000</span><span class="number">-01</span><span class="number">-10</span> <span class="number">-0.905394</span>  <span class="number">0.282200</span>   <span class="number">3.153474</span>  <span class="number">-0.189584</span> </div><div class="line"><span class="number">10</span>   <span class="number">2000</span><span class="number">-01</span><span class="number">-11</span> <span class="number">-0.962155</span> <span class="number">-1.147225</span>   <span class="number">3.353251</span>   <span class="number">1.283288</span> </div><div class="line"><span class="number">11</span>   <span class="number">2000</span><span class="number">-01</span><span class="number">-12</span> <span class="number">-1.853063</span> <span class="number">-1.539308</span>   <span class="number">5.246351</span>   <span class="number">0.222400</span> </div><div class="line"><span class="number">12</span>   <span class="number">2000</span><span class="number">-01</span><span class="number">-13</span> <span class="number">-3.385665</span> <span class="number">-2.982384</span>   <span class="number">3.952838</span>   <span class="number">0.319281</span> </div><div class="line"><span class="number">13</span>   <span class="number">2000</span><span class="number">-01</span><span class="number">-14</span> <span class="number">-4.411986</span> <span class="number">-2.914887</span>   <span class="number">4.775386</span>   <span class="number">0.597495</span> </div><div class="line"><span class="number">14</span>   <span class="number">2000</span><span class="number">-01</span><span class="number">-15</span> <span class="number">-5.938706</span> <span class="number">-3.437068</span>   <span class="number">6.882886</span>   <span class="number">1.105879</span> </div><div class="line"><span class="number">15</span>   <span class="number">2000</span><span class="number">-01</span><span class="number">-16</span> <span class="number">-6.537699</span> <span class="number">-1.947668</span>   <span class="number">8.142251</span>   <span class="number">0.948407</span> </div><div class="line"><span class="number">16</span>   <span class="number">2000</span><span class="number">-01</span><span class="number">-17</span> <span class="number">-6.786304</span> <span class="number">-2.735740</span>   <span class="number">8.484593</span>   <span class="number">1.034685</span> </div><div class="line"><span class="number">17</span>   <span class="number">2000</span><span class="number">-01</span><span class="number">-18</span> <span class="number">-7.145344</span> <span class="number">-1.666703</span>   <span class="number">9.420653</span>  <span class="number">-0.919941</span> </div><div class="line"><span class="number">18</span>   <span class="number">2000</span><span class="number">-01</span><span class="number">-19</span> <span class="number">-8.283291</span>  <span class="number">0.101307</span>  <span class="number">10.654933</span>  <span class="number">-0.936284</span> </div><div class="line"><span class="number">19</span>   <span class="number">2000</span><span class="number">-01</span><span class="number">-20</span> <span class="number">-8.330414</span>  <span class="number">0.820054</span>  <span class="number">11.207165</span>  <span class="number">-2.622354</span> </div><div class="line"><span class="number">20</span>   <span class="number">2000</span><span class="number">-01</span><span class="number">-21</span> <span class="number">-7.942291</span>  <span class="number">1.559753</span>   <span class="number">9.201008</span>  <span class="number">-2.923220</span> </div><div class="line"><span class="number">21</span>   <span class="number">2000</span><span class="number">-01</span><span class="number">-22</span> <span class="number">-4.675543</span>  <span class="number">2.337827</span>  <span class="number">10.364670</span>  <span class="number">-3.112916</span> </div><div class="line"><span class="number">22</span>   <span class="number">2000</span><span class="number">-01</span><span class="number">-23</span> <span class="number">-5.774614</span>  <span class="number">0.408297</span>   <span class="number">9.441821</span>  <span class="number">-2.040018</span> </div><div class="line"><span class="number">23</span>   <span class="number">2000</span><span class="number">-01</span><span class="number">-24</span> <span class="number">-5.993547</span> <span class="number">-0.480329</span>  <span class="number">10.311053</span>   <span class="number">0.852373</span> </div><div class="line"><span class="number">24</span>   <span class="number">2000</span><span class="number">-01</span><span class="number">-25</span> <span class="number">-4.137167</span>  <span class="number">0.099883</span>  <span class="number">10.224100</span>   <span class="number">0.576367</span> </div><div class="line"><span class="number">25</span>   <span class="number">2000</span><span class="number">-01</span><span class="number">-26</span> <span class="number">-2.866354</span> <span class="number">-0.772702</span>  <span class="number">11.812000</span>   <span class="number">1.671981</span> </div><div class="line"><span class="number">26</span>   <span class="number">2000</span><span class="number">-01</span><span class="number">-27</span> <span class="number">-1.764316</span> <span class="number">-2.534161</span>  <span class="number">11.634361</span>   <span class="number">1.638750</span> </div><div class="line"><span class="number">27</span>   <span class="number">2000</span><span class="number">-01</span><span class="number">-28</span> <span class="number">-3.220852</span> <span class="number">-3.353006</span>  <span class="number">11.399995</span>  <span class="number">-0.562762</span> </div><div class="line"><span class="number">28</span>   <span class="number">2000</span><span class="number">-01</span><span class="number">-29</span> <span class="number">-0.889241</span> <span class="number">-2.794083</span>  <span class="number">10.445614</span>   <span class="number">0.473105</span> </div><div class="line"><span class="number">29</span>   <span class="number">2000</span><span class="number">-01</span><span class="number">-30</span>  <span class="number">0.428342</span> <span class="number">-3.857681</span>  <span class="number">10.930199</span>  <span class="number">-0.118981</span> </div><div class="line">..          ...       ...       ...        ...        ... </div><div class="line"><span class="number">970</span>  <span class="number">2002</span><span class="number">-08</span><span class="number">-28</span> <span class="number">-2.853884</span> <span class="number">-2.041226</span>  <span class="number">28.387424</span>  <span class="number">17.129529</span> </div><div class="line"><span class="number">971</span>  <span class="number">2002</span><span class="number">-08</span><span class="number">-29</span> <span class="number">-5.058352</span>  <span class="number">0.041153</span>  <span class="number">28.095666</span>  <span class="number">16.654813</span> </div><div class="line"><span class="number">972</span>  <span class="number">2002</span><span class="number">-08</span><span class="number">-30</span> <span class="number">-4.478272</span> <span class="number">-1.613275</span>  <span class="number">26.989764</span>  <span class="number">17.653338</span> </div><div class="line"><span class="number">973</span>  <span class="number">2002</span><span class="number">-08</span><span class="number">-31</span> <span class="number">-2.815382</span> <span class="number">-2.764649</span>  <span class="number">26.197949</span>  <span class="number">16.442647</span> </div><div class="line"><span class="number">974</span>  <span class="number">2002</span><span class="number">-09</span><span class="number">-01</span> <span class="number">-2.621575</span> <span class="number">-2.785604</span>  <span class="number">28.007243</span>  <span class="number">14.962121</span> </div><div class="line"><span class="number">975</span>  <span class="number">2002</span><span class="number">-09</span><span class="number">-02</span> <span class="number">-2.476145</span> <span class="number">-3.128888</span>  <span class="number">27.541079</span>  <span class="number">12.853070</span> </div><div class="line"><span class="number">976</span>  <span class="number">2002</span><span class="number">-09</span><span class="number">-03</span> <span class="number">-0.483923</span> <span class="number">-3.061629</span>  <span class="number">27.130099</span>  <span class="number">13.401077</span> </div><div class="line"><span class="number">977</span>  <span class="number">2002</span><span class="number">-09</span><span class="number">-04</span> <span class="number">-0.885055</span> <span class="number">-2.059356</span>  <span class="number">26.139260</span>  <span class="number">12.725815</span> </div><div class="line"><span class="number">978</span>  <span class="number">2002</span><span class="number">-09</span><span class="number">-05</span> <span class="number">-3.438688</span> <span class="number">-3.060238</span>  <span class="number">26.267361</span>  <span class="number">13.601928</span> </div><div class="line"><span class="number">979</span>  <span class="number">2002</span><span class="number">-09</span><span class="number">-06</span> <span class="number">-3.646110</span> <span class="number">-2.908451</span>  <span class="number">27.639157</span>  <span class="number">13.749199</span> </div><div class="line"><span class="number">980</span>  <span class="number">2002</span><span class="number">-09</span><span class="number">-07</span> <span class="number">-3.742097</span> <span class="number">-5.843492</span>  <span class="number">27.138204</span>  <span class="number">14.621900</span> </div><div class="line"><span class="number">981</span>  <span class="number">2002</span><span class="number">-09</span><span class="number">-08</span> <span class="number">-4.367495</span> <span class="number">-5.523435</span>  <span class="number">26.429433</span>  <span class="number">14.372776</span> </div><div class="line"><span class="number">982</span>  <span class="number">2002</span><span class="number">-09</span><span class="number">-09</span> <span class="number">-6.481100</span> <span class="number">-7.691100</span>  <span class="number">26.325775</span>  <span class="number">14.060133</span> </div><div class="line"><span class="number">983</span>  <span class="number">2002</span><span class="number">-09</span><span class="number">-10</span> <span class="number">-4.406432</span> <span class="number">-5.925796</span>  <span class="number">25.808105</span>  <span class="number">13.717117</span> </div><div class="line"><span class="number">984</span>  <span class="number">2002</span><span class="number">-09</span><span class="number">-11</span> <span class="number">-5.747746</span> <span class="number">-6.226884</span>  <span class="number">26.334882</span>  <span class="number">13.539911</span> </div><div class="line"><span class="number">985</span>  <span class="number">2002</span><span class="number">-09</span><span class="number">-12</span> <span class="number">-5.075507</span> <span class="number">-5.976265</span>  <span class="number">25.582403</span>  <span class="number">13.955776</span> </div><div class="line"><span class="number">986</span>  <span class="number">2002</span><span class="number">-09</span><span class="number">-13</span> <span class="number">-5.957833</span> <span class="number">-4.514403</span>  <span class="number">26.154568</span>  <span class="number">15.948706</span> </div><div class="line"><span class="number">987</span>  <span class="number">2002</span><span class="number">-09</span><span class="number">-14</span> <span class="number">-4.822016</span> <span class="number">-3.510714</span>  <span class="number">26.770429</span>  <span class="number">14.903106</span> </div><div class="line"><span class="number">988</span>  <span class="number">2002</span><span class="number">-09</span><span class="number">-15</span> <span class="number">-5.413908</span> <span class="number">-3.678965</span>  <span class="number">29.255640</span>  <span class="number">15.903795</span> </div><div class="line"><span class="number">989</span>  <span class="number">2002</span><span class="number">-09</span><span class="number">-16</span> <span class="number">-7.305733</span> <span class="number">-4.970404</span>  <span class="number">30.726133</span>  <span class="number">17.075891</span> </div><div class="line"><span class="number">990</span>  <span class="number">2002</span><span class="number">-09</span><span class="number">-17</span> <span class="number">-6.921962</span> <span class="number">-3.342561</span>  <span class="number">32.499852</span>  <span class="number">15.309124</span> </div><div class="line"><span class="number">991</span>  <span class="number">2002</span><span class="number">-09</span><span class="number">-18</span> <span class="number">-7.650811</span> <span class="number">-3.539989</span>  <span class="number">31.823857</span>  <span class="number">15.100428</span> </div><div class="line"><span class="number">992</span>  <span class="number">2002</span><span class="number">-09</span><span class="number">-19</span> <span class="number">-7.680999</span> <span class="number">-2.289270</span>  <span class="number">31.098525</span>  <span class="number">12.891011</span> </div><div class="line"><span class="number">993</span>  <span class="number">2002</span><span class="number">-09</span><span class="number">-20</span> <span class="number">-7.849671</span> <span class="number">-1.712562</span>  <span class="number">31.364746</span>  <span class="number">13.909086</span> </div><div class="line"><span class="number">994</span>  <span class="number">2002</span><span class="number">-09</span><span class="number">-21</span> <span class="number">-8.739466</span> <span class="number">-2.122690</span>  <span class="number">32.004201</span>  <span class="number">14.095981</span> </div><div class="line"><span class="number">995</span>  <span class="number">2002</span><span class="number">-09</span><span class="number">-22</span> <span class="number">-8.740361</span> <span class="number">-0.656488</span>  <span class="number">29.674406</span>  <span class="number">12.590248</span> </div><div class="line"><span class="number">996</span>  <span class="number">2002</span><span class="number">-09</span><span class="number">-23</span> <span class="number">-6.309331</span> <span class="number">-0.986256</span>  <span class="number">30.370786</span>  <span class="number">13.450941</span> </div><div class="line"><span class="number">997</span>  <span class="number">2002</span><span class="number">-09</span><span class="number">-24</span> <span class="number">-6.205371</span> <span class="number">-0.419119</span>  <span class="number">30.260205</span>  <span class="number">12.028273</span> </div><div class="line"><span class="number">998</span>  <span class="number">2002</span><span class="number">-09</span><span class="number">-25</span> <span class="number">-7.573782</span> <span class="number">-2.492400</span>  <span class="number">31.063298</span>  <span class="number">12.361099</span> </div><div class="line"><span class="number">999</span>  <span class="number">2002</span><span class="number">-09</span><span class="number">-26</span> <span class="number">-7.317950</span> <span class="number">-2.840246</span>  <span class="number">31.560766</span>  <span class="number">12.502660</span></div></pre></td></tr></table></figure>
<h4 id="HDF5"><a href="#HDF5" class="headerlink" title="HDF5"></a>HDF5</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">129</span>]: df.to_hdf(<span class="string">'foo.h5'</span>,<span class="string">'df'</span>)</div><div class="line"></div><div class="line">In [<span class="number">130</span>]: pd.read_hdf(<span class="string">'foo.h5'</span>,<span class="string">'df'</span>)</div></pre></td></tr></table></figure>
<h4 id="Excel"><a href="#Excel" class="headerlink" title="Excel"></a>Excel</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">131</span>]: df.to_excel(<span class="string">'foo.xlsx'</span>, sheet_name=<span class="string">'Sheet1'</span>)</div><div class="line"></div><div class="line">In [<span class="number">132</span>]: pd.read_excel(<span class="string">'foo.xlsx'</span>, <span class="string">'Sheet1'</span>, index_col=<span class="keyword">None</span>, na_values=[<span class="string">'NA'</span>])</div></pre></td></tr></table></figure>
<h3 id="坑"><a href="#坑" class="headerlink" title="坑"></a>坑</h3><p>如下，不能直接把返回值当作布尔值。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">131</span>]: <span class="keyword">if</span> pd.Series([<span class="keyword">False</span>, <span class="keyword">True</span>, <span class="keyword">False</span>]):</div><div class="line">     ...:     print(<span class="string">'I was true'</span>)</div><div class="line">     ...:</div><div class="line">---------------------------------------------------------------------------</div><div class="line">ValueError                                Traceback (most recent call last)</div><div class="line">&lt;ipython-input<span class="number">-131</span>-ec15f6b92216&gt; <span class="keyword">in</span> &lt;module&gt;()</div><div class="line">----&gt; 1 if pd.Series([False, True, False]):</div><div class="line">      <span class="number">2</span>     print(<span class="string">'I was true'</span>)</div><div class="line">      <span class="number">3</span></div><div class="line"></div><div class="line">c:\python34\lib\site-packages\pandas\core\generic.py <span class="keyword">in</span> __nonzero__(self)</div><div class="line">    <span class="number">953</span>         <span class="keyword">raise</span> ValueError(<span class="string">"The truth value of a &#123;0&#125; is ambiguous. "</span></div><div class="line">    <span class="number">954</span>                          <span class="string">"Use a.empty, a.bool(), a.item(), a.any() or a.all()."</span></div><div class="line">--&gt; 955                          .format(self.__class__.__name__))</div><div class="line">    <span class="number">956</span></div><div class="line">    <span class="number">957</span>     __bool__ = __nonzero__</div><div class="line"></div><div class="line">ValueError: The truth value of a Series <span class="keyword">is</span> ambiguous. Use a.empty, a.bool(), a.item(), a.any() <span class="keyword">or</span> a.all().</div></pre></td></tr></table></figure></p>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul>
<li><a href="http://pandas.pydata.org/pandas-docs/stable/10min.html" target="_blank" rel="external">pandas十分钟入门</a></li>
</ul>
</div><div class="tags"><a href="/tags/python/">python</a></div><div class="post-nav"><a href="/2017/06/09/python-magicVarFunc-2017-06-09/" class="pre">Python之_magic变量和函数</a><a href="/2017/06/08/python-numpy-2017-06-08/" class="next">Python之Numpy使用</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Web/">Web</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/js/">js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/node/">node</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/vue/">vue</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/">web</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/工具/">工具</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/思想/">思想</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据库/">数据库</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/编程/">编程</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/随笔/">随笔</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/http/" style="font-size: 15px;">http</a> <a href="/tags/python/" style="font-size: 15px;">python</a> <a href="/tags/算法/" style="font-size: 15px;">算法</a> <a href="/tags/node/" style="font-size: 15px;">node</a> <a href="/tags/C-C/" style="font-size: 15px;">C/C++</a> <a href="/tags/计算机基础/" style="font-size: 15px;">计算机基础</a> <a href="/tags/谷歌/" style="font-size: 15px;">谷歌</a> <a href="/tags/OOP/" style="font-size: 15px;">OOP</a> <a href="/tags/css/" style="font-size: 15px;">css</a> <a href="/tags/设计模式/" style="font-size: 15px;">设计模式</a> <a href="/tags/flask/" style="font-size: 15px;">flask</a> <a href="/tags/Hexo/" style="font-size: 15px;">Hexo</a> <a href="/tags/Git/" style="font-size: 15px;">Git</a> <a href="/tags/方法/" style="font-size: 15px;">方法</a> <a href="/tags/js/" style="font-size: 15px;">js</a> <a href="/tags/linux/" style="font-size: 15px;">linux</a> <a href="/tags/Markdown/" style="font-size: 15px;">Markdown</a> <a href="/tags/MongoDB/" style="font-size: 15px;">MongoDB</a> <a href="/tags/MySQL/" style="font-size: 15px;">MySQL</a> <a href="/tags/NSIS/" style="font-size: 15px;">NSIS</a> <a href="/tags/web/" style="font-size: 15px;">web</a> <a href="/tags/scrapy/" style="font-size: 15px;">scrapy</a> <a href="/tags/PyQt5/" style="font-size: 15px;">PyQt5</a> <a href="/tags/RegExp/" style="font-size: 15px;">RegExp</a> <a href="/tags/Tools/" style="font-size: 15px;">Tools</a> <a href="/tags/SVN/" style="font-size: 15px;">SVN</a> <a href="/tags/tornado/" style="font-size: 15px;">tornado</a> <a href="/tags/vue/" style="font-size: 15px;">vue</a> <a href="/tags/redis/" style="font-size: 15px;">redis</a> <a href="/tags/爬虫/" style="font-size: 15px;">爬虫</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/02/01/py-asyncio-coroutine-2018-02-01/">关于coroutine</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/02/01/spiderallsite-2018-02-01/">全站爬虫</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/25/linux-crontab-2018-01-25/">linux之crontab使用</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/16/py-scrapy2-2018-01-16/">scrapy笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/15/py-scrapy1-2018-01-15/">scrapy笔记-安装</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/15/py-pipcmds-2018-01-15/">python之pip常用命令</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/11/css-note1-2018-01-11/">css笔记1</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/11/selenium-phatomjs-2017-12-11/">selenium-phatomjs使用</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/08/jQuery-notes1-2017-12-08/">jQuery笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/08/js-dom-2017-12-08/">javascript之DOM操作</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a href="/." rel="nofollow">Simple &amp; Freedom.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.css"><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>